# **–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏ —Ö—É–∫–æ–≤ BatumiTrip**

> –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è –µ–¥–∏–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∏—Å—Ç–∏–Ω—ã (source¬†of¬†truth) –æ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –∫–æ–¥–∞ –ø—Ä–æ–µ–∫—Ç–∞ Batumi¬†Trip. –û–Ω —Å–ª—É–∂–∏—Ç –æ–ø–æ—Ä–æ–π –¥–ª—è AI‚Äë–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –∫–æ–¥–∞ –∏ –≤—Å–µ–π –∫–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è –¥–µ—Ç–∞–ª—å–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, —Ö—É–∫–æ–≤ –∏ —É—Ç–∏–ª–∏—Ç. –ò—Å–ø–æ–ª—å–∑—É—è —ç—Ç–æ—Ç —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫, AI —Å–º–æ–∂–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥, –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è –ø–æ —Å—Ç–∏–ª—é.
---
## –ò–µ—Ä–∞—Ä—Ö–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
```text
RootLayout
‚îú‚îÄ <html>
‚îÇ  ‚îî‚îÄ <body>
‚îÇ     ‚îú‚îÄ Providers
‚îÇ     ‚îÇ  ‚îú‚îÄ QueryClientProvider
‚îÇ     ‚îÇ  ‚îÇ  ‚îî‚îÄ ReactQueryDevtools   (—Ç–æ–ª—å–∫–æ –≤ development)
‚îÇ     ‚îÇ  ‚îú‚îÄ AuthProvider
‚îÇ     ‚îÇ  ‚îÇ  ‚îî‚îÄ SessionProvider
‚îÇ     ‚îÇ  ‚îî‚îÄ ThemeProvider
‚îÇ     ‚îÇ     ‚îî‚îÄ NextThemesProvider
‚îÇ     ‚îú‚îÄ FavouriteFetcher
‚îÇ     ‚îî‚îÄ {page children}
‚îÇ
‚îú‚îÄ / (LocationListPage)
‚îÇ  ‚îú‚îÄ TagsPrefetcher
‚îÇ  ‚îú‚îÄ Header
‚îÇ  ‚îÇ  ‚îú‚îÄ Logo¬†<Link>
‚îÇ  ‚îÇ  ‚îú‚îÄ Search‚ÄØ<button> ‚îÄ‚îê
‚îÇ  ‚îÇ  ‚îÇ                   ‚îî‚îÄ SearchBar¬†(–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è/–∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è)
‚îÇ  ‚îÇ  ‚îÇ                      ‚îú‚îÄ Input
‚îÇ  ‚îÇ  ‚îÇ                      ‚îî‚îÄ TagBadge¬†√ó‚ÄØN
‚îÇ  ‚îÇ  ‚îú‚îÄ Login/Logout‚ÄØ<Button>
‚îÇ  ‚îÇ  ‚îî‚îÄ LoginModal¬†(–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ Zustand)
‚îÇ  ‚îú‚îÄ LocationList
‚îÇ  ‚îÇ  ‚îú‚îÄ (SkeletonCard¬†√ó‚ÄØ6)                          ‚Äì –ø–æ–∫–∞ –∏–¥—ë—Ç –Ω–∞—á–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
‚îÇ  ‚îÇ  ‚îú‚îÄ LocationCard¬†√ó‚ÄØN
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ <Image>
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ TagBadge¬†√ó‚ÄØM
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ Favourite¬†<button>
‚îÇ  ‚îÇ  ‚îî‚îÄ Intersection‚Äëobserver¬†<div>                 ‚Äì —Ç—Ä–∏–≥–≥–µ—Ä –±–µ—Å–∫. –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
‚îÇ  ‚îî‚îÄ AddLocationButton  ‚Üí¬†<Link¬†href="/locations/new">
‚îÇ
‚îú‚îÄ /locations/new (AddLocationPage)
‚îÇ  ‚îî‚îÄ LocationForm
‚îÇ     ‚îú‚îÄ Input¬†(–∑–∞–≥–æ–ª–æ–≤–æ–∫)
‚îÇ     ‚îú‚îÄ Textarea¬†(–æ–ø–∏—Å–∞–Ω–∏–µ)
‚îÇ     ‚îú‚îÄ Input¬†(–∞–¥—Ä–µ—Å, —Å—Ç–æ–∏–º–æ—Å—Ç—å, sourceUrl)
‚îÇ     ‚îú‚îÄ ChooseTag
‚îÇ     ‚îÇ  ‚îú‚îÄ Inline¬†<span>¬†(—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ–≥–∏)
‚îÇ     ‚îÇ  ‚îî‚îÄ Input¬†+‚ÄØButton¬†(–¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–µ–≥)
‚îÇ     ‚îú‚îÄ AttachImage
‚îÇ     ‚îÇ  ‚îú‚îÄ <input type="file">
‚îÇ     ‚îÇ  ‚îî‚îÄ <img>¬†(–ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä‚ÄØ/‚ÄØX¬†<button>)
‚îÇ     ‚îî‚îÄ Button¬†(–°–æ—Ö—Ä–∞–Ω–∏—Ç—å)
‚îÇ
‚îú‚îÄ /locations/[id] (LocationDetailPage)
‚îÇ  ‚îÇ  (SkeletonCard¬†‚Äî –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ)
‚îÇ  ‚îÇ  (–û—à–∏–±–∫–∞¬†<div>¬†‚Äî –ø—Ä–∏ isError)
‚îÇ  ‚îî‚îÄ {!isEditing
‚îÇ      ‚îú‚îÄ LocationDetail
‚îÇ      ‚îÇ  ‚îú‚îÄ <Image>
‚îÇ      ‚îÇ  ‚îú‚îÄ TagBadge¬†√ó‚ÄØM
‚îÇ      ‚îÇ  ‚îî‚îÄ Button‚ÄØ(–ù–∞–∑–∞–¥)
‚îÇ      ‚îî‚îÄ [–µ—Å–ª–∏ –∞–≤—Ç–æ—Ä]¬†Edit¬†&¬†Delete¬†<Button>
‚îÇ     : LocationForm¬†(—Ä–µ–∂–∏–º‚ÄØEdit)¬†+‚ÄØButton¬†(–û—Ç–º–µ–Ω–∞)
‚îÇ
‚îî‚îÄ API / —Å–ª—É–∂–µ–±–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ DOM‚Äë–¥–µ—Ä–µ–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü)
   ‚îú‚îÄ route.js¬†(NextAuth¬†endpoint)
   ‚îî‚îÄ SkeletonCard, TagBadge, etc. ‚Äî –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ UI‚Äë—ç–ª–µ–º–µ–Ω—Ç—ã
```

---
## –ê–∫—Ç—É–∞–ª—å–Ω—ã–π –∫–æ–¥ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### Layout.js

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ì–ª–æ–±–∞–ª—å–Ω—ã–π –º–∞–∫–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –æ–±–æ—Ä–∞—á–∏–≤–∞—é—â–∏–π –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã. –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —É—Å—Ç–∞–Ω–æ–≤–∫—É –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ (React Query Provider, Context –¥–ª—è —Ç–µ–º—ã), –ø—Ä–æ–≤–µ—Ä–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –æ–±—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Header` –∏ `LoginModal`).
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ö—É–∫ `useAuth` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–Ω–æ–ø–∫—É –≤—Ö–æ–¥–∞ –≤ `Header`. –í–∫–ª—é—á–∞–µ—Ç –≤ —Ä–∞–∑–º–µ—Ç–∫—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã `Header` –∏ `LoginModal`.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ Layout.js:**
```js
import '@/styles/globals.css';
import Providers from '@/components/Providers';
import FavouriteFetcher from '@/lib/FavouriteFetcher';
export const metadata = {
  title: 'Batumi¬†Trip',
  description: 'SPA –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –¥—Ä—É–∑–µ–π –≤¬†–ë–∞—Ç—É–º–∏',
};

export default function RootLayout({ children }) {
  return (
    <html lang="ru" suppressHydrationWarning>
      <body>
        <Providers>
          <FavouriteFetcher />
          {children}
          </Providers>
      </body>
    </html>
  );
}
```

---
### LocationListPage (–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–ø–∏—Å–∫–∞)

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°—Ç—Ä–∞–Ω–∏—Ü–∞-–ª–µ–Ω–¥–∏–Ω–≥, –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–∞—è –≤–µ—Å—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–∏—Å–∫–∞ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–ø–∏—Å–∫–∞ –ª–æ–∫–∞—Ü–∏–π —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é—Ç—Å—è `SearchBar`, `AddLocationButton` –∏ `LocationList`. –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç—Å—è —Ö—É–∫ `useLocations`, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç –ø–µ—Ä–≤—ã–µ –ª–æ–∫–∞—Ü–∏–∏. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–≤–æ–¥–∏—Ç—å —Ç–µ–∫—Å—Ç –ø–æ–∏—Å–∫–∞ (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ Zustand), –∏ –∑–∞–ø—Ä–æ—Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è. –ö–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ç–æ–ª—å–∫–æ —á—Ç–æ –≤–æ—à–µ–ª, `LocationList` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `SkeletonCard`.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ LocationListPage:**
```js
// app/page.js  (—Ä–æ—É—Ç /)
import LocationList from '@/components/LocationList';
import AddLocationButton from '@/components/AddLocationButton'
import Header from '@/components/Header';
import TagsPrefetcher from '@/lib/TagsPrefetcher';
import FavouriteFilterButton from '@/components/FavouriteFilterButton';

export default function LocationListPage() {
  return (
    <main className="container mx-auto px-4 py-6 space-y-6">
      <TagsPrefetcher />
      <Header />
      <LocationList />
      <AddLocationButton />
      <FavouriteFilterButton />
    </main>
  );
}
```

---
### AddLocationPage - `app/locations/new/page.js`

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Ñ–æ—Ä–º–æ–π —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –ª–æ–∫–∞—Ü–∏–∏.
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –°–æ–¥–µ—Ä–∂–∏—Ç `LocationForm` –±–µ–∑ `initialData`. –°–∞–±–º–∏—Ç —Ñ–æ—Ä–º—ã –≤—ã–∑—ã–≤–∞–µ—Ç `useAddLocation().mutate(data)`, –∞¬†–ø—Ä–∏ —É—Å–ø–µ—Ö–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–æ–≤–æ–π –ª–æ–∫–∞—Ü–∏–∏.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ AddLocationPage:**
```js
'use client';
import React from 'react';
import LocationForm from '@/components/LocationForm';

export default function AddLocationPage() {
  return (
    <main className="container mx-auto px-4 py-6">
      <h1 className="text-2xl font-bold mb-4">–î–æ–±–∞–≤–∏—Ç—å –ª–æ–∫–∞—Ü–∏—é</h1>
      <LocationForm />
    </main>
  );
}
```

---
### LocationDetailPage (–°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏)

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –ø–æ–ª–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ª–æ–∫–∞—Ü–∏–∏.
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `id` –≤—ã–∑—ã–≤–∞–µ—Ç `useOneLocation(id)`‚ÄØ`(useQuery(['location', id]))` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—ä–µ–∫—Ç–∞; –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—ë—Ç –≤ `LocationDetail`. –ö–Ω–æ–ø–∫–∏ `EditButton`‚ÄØ–∏‚ÄØ`DeleteButton` –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ö—É–∫–∏ `useUpdateLocation()` –∏ `useDeleteLocation()` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ LocationDetailPage:**
```js
// app/locations/[id]/page.jsx
'use client';
import { useState } from 'react';
import { useParams, useRouter } from 'next/navigation';
import { useAuth } from '@/hooks/useAuth';
import { useOneLocation } from '@/hooks/useOneLocation';
import { useDeleteLocation } from '@/hooks/useDeleteLocation';
import LocationDetail from '@/components/LocationDetail';
import LocationForm from '@/components/LocationForm';
import SkeletonCard from '@/components/SkeletonCard';
import { Button } from '@/components/ui/button';

export default function LocationDetailPage() {
  const { id } = useParams();
  const { user, isLoading: authLoading } = useAuth();
  const { data: location, isLoading, isError } = useOneLocation(id);
  const [isEditing, setIsEditing] = useState(false);
  const router = useRouter();
  // —Ö—É–∫ —É–¥–∞–ª–µ–Ω–∏—è
  const deleteMutation = useDeleteLocation();
  // –ø–æ–∫–∞ –∏–¥—ë—Ç –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–∫–µ–ª–µ—Ç–æ–Ω
  if (isLoading || authLoading) {
    return (
      <main className="container mx-auto px-4 py-6">
        <SkeletonCard />
      </main>
    );
  }

  if (isError || !location) {
    return (
      <main className="container mx-auto px-4 py-6 text-destructive">
        –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ª–æ–∫–∞—Ü–∏—é.
      </main>
    );
  }
  // —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä (location.user_id) –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å / —É–¥–∞–ª—è—Ç—å
  const canEdit = user?.id === location.user_id;
  // —É–¥–∞–ª–µ–Ω–∏–µ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
  const handleDelete = () => {
    if (!window.confirm('–£–¥–∞–ª–∏—Ç—å –ª–æ–∫–∞—Ü–∏—é –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ?')) return;
    deleteMutation.mutate(
      { id, imageUrl: location.imgUrl },
      {
        onSuccess: () => {
          router.push('/');
        },
      },
    );
  };

  return (
    <main className="container mx-auto px-4 py-6 space-y-6">
      {/* 3. –†–µ–Ω–¥–µ—Ä–∏–º –ª–∏–±–æ –ø—Ä–æ—Å–º–æ—Ç—Ä, –ª–∏–±–æ —Ñ–æ—Ä–º—É */}
      {!isEditing ? (
        <>
          <LocationDetail location={location} />
          {/* 1+2. –ö–Ω–æ–ø–∫–∏ ¬´–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å¬ª –∏ ¬´–£–¥–∞–ª–∏—Ç—å¬ª –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä—É */}
          {canEdit && (
            <div className="flex flex-wrap gap-3">
              <Button variant="secondary" onClick={() => setIsEditing(true)}>
                –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
              </Button>
              <Button
                variant="destructive"
                onClick={handleDelete}
                disabled={deleteMutation.isLoading}
              >
                {deleteMutation.isLoading ? '–£–¥–∞–ª—è–µ–º‚Ä¶' : '–£–¥–∞–ª–∏—Ç—å'}
              </Button>
            </div>
          )}
        </>
      ) : (
        <>
          <h1 className="text-2xl font-bold">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞—Ü–∏—é</h1>
          <LocationForm
            initialData={location}
            onSuccess={() => {
              setIsEditing(false);
            }}
          />
          <Button variant="link" onClick={() => setIsEditing(false)}>
            –û—Ç–º–µ–Ω–∞
          </Button>
        </>
      )}
    </main>
  );
}
```

---
### Header

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å (–æ–±—ã—á–Ω–æ —à–∞–ø–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã) —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –∫–Ω–æ–ø–∫–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏/–≤—ã—Ö–æ–¥–∞.
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–ª–∏ –ª–æ–≥–æ—Ç–∏–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–í–æ–π—Ç–∏". –ù–∞–∂–∞—Ç–∏–µ –Ω–∞ –∫–Ω–æ–ø–∫—É "–í–æ–π—Ç–∏" –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `LoginModal` (–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä Zustand). –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –∫–Ω–æ–ø–∫—É "–í—ã–π—Ç–∏", –≤—ã–∑—ã–≤–∞—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é `signOut()` –∏–∑ `useAuth`.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ Header.js:**
```js
"use client";
import { useState, useRef } from "react";
import Image from "next/image";
import Link from "next/link";
import dynamic from "next/dynamic";
import animationData from "@/public/userAnimation.json";
import { useAuth } from "@/hooks/useAuth";
import { useUIStore } from "@/store/uiStore";
import { Button } from "@/components/ui/button";
import LoginModal from "@/components/LoginModal";
import { motion, AnimatePresence } from "framer-motion";
import { LogIn, Search } from "lucide-react";
import { cn } from "@/lib/utils";
import SearchBar from "@/components/SearchBar";
import {
  DropdownMenu,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuItem,
} from "@/components/ui/dropdown-menu";
const Lottie = dynamic(() => import("lottie-react"), { ssr: false });

export default function Header({ className }) {
  const { user, signOut } = useAuth();
  const setLoginModal = useUIStore((s) => s.setLoginModal);
  const [isSearchOpen, setSearchOpen] = useState(false);
  const lottieRef = useRef(null);

  const handleLoginClick = () => setLoginModal(true);
  const toggleSearch = () => setSearchOpen((o) => !o);
  /** –ó–∞–ø—É—Å–∫–∞–µ–º –æ–¥–∏–Ω —Ü–∏–∫–ª –∞–Ω–∏–º–∞—Ü–∏–∏ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ */
  const playAnimation = () => {
    if (lottieRef.current) {
      lottieRef.current.goToAndPlay(0, true);
    }
  };

  return (
    <>
      {/* ---------- –®–∞–ø–∫–∞ ---------- */}
      <motion.header
        initial={{ y: -16, opacity: 0 }}
        animate={{ y: 0, opacity: 1 }}
        transition={{ duration: 0.25, ease: "easeOut" }}
        className={cn(
          "sticky top-0 z-30 flex w-full items-center justify-between px-4 py-3",
          "bg-primary/90 backdrop-blur-md supports-[backdrop-filter]:bg-foreground/80",
          "shadow-md text-primary-foreground",
          className,
        )}
      >
        {/* –õ–æ–≥–æ—Ç–∏–ø */}
        <Link href="/" className="flex items-center">
          <Image
            src="/logo.png"
            alt="Batumi Trip logo"
            width={150}
            height={100}
            className="object-contain"
          />
          <span className="sr-only">Batumi Trip</span>
        </Link>
        {/* –ò–∫–æ–Ω–∫–∞ –ø–æ–∏—Å–∫–∞ */}
        <button
          onClick={toggleSearch}
          aria-label="–ü–æ–∏—Å–∫"
          className="p-2 rounded focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary"
        >
          <Search className="h-6 w-6" aria-hidden="true" />
        </button>
        {/* ---------- Auth‚Äë–±–ª–æ–∫ ---------- */}
        {user ? (
          <DropdownMenu modal={false}>
            <DropdownMenuTrigger asChild>
              <div
                role="button"
                aria-label="–ú–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
                className="h-10 w-10 rounded-full overflow-hidden focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary"
                onClick={playAnimation}
              >
                <Lottie
                  lottieRef={lottieRef}
                  animationData={animationData}
                  loop={false}
                  autoplay={false}
                  className="h-10 w-10"
                />
              </div>
            </DropdownMenuTrigger>

            <DropdownMenuContent align="end" className="w-44">
              <DropdownMenuLabel className="block w-full text-center uppercase truncate select-none tracking-wide px-2 py-1">
                {user.id}
              </DropdownMenuLabel>
              <DropdownMenuSeparator />
              <DropdownMenuItem
                onSelect={(e) => {
                  e.preventDefault();
                  signOut();
                }}
                className="text-destructive focus:text-destructive"
              >
                –í—ã–π—Ç–∏
              </DropdownMenuItem>
            </DropdownMenuContent>
          </DropdownMenu>
        ) : (
          <Button
            size="md"
            onClick={handleLoginClick}
            aria-label="–í–æ–π—Ç–∏"
            className="gap-2 px-4 py-2"
          >
            <LogIn className="h-5 w-5" aria-hidden="true" />
            <span className="not-sr-only">–í–æ–π—Ç–∏</span>
          </Button>
        )}
      </motion.header>
      {/* ---------- –ü–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ ---------- */}
      <AnimatePresence>
        {isSearchOpen && (
          <motion.div
            initial={{ height: 0, opacity: 0 }}
            animate={{ height: "auto", opacity: 1 }}
            exit={{ height: 0, opacity: 0 }}
            transition={{ duration: 0.2 }}
          >
            <div className="container mx-auto px-4 py-2 flex justify-end">
              <SearchBar placeholder="–î–∞–≤–∞–π—Ç–µ –Ω–∞–π–¥—ë–º —á—Ç–æ-—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ üßê" />
            </div>
          </motion.div>
        )}
      </AnimatePresence>
      {/* ---------- –ú–æ–¥–∞–ª–∫–∞ –ª–æ–≥–∏–Ω–∞ ---------- */}
      <LoginModal />
    </>
  );
}
```
---
### SearchBar

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª–µ –ø–æ–∏—Å–∫–∞ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç, –æ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Zustand) –∫–∞–∫ —Ç–µ–∫—É—â–∏–π –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å (`searchQuery`). –ü–æ–∏—Å–∫–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `useLocations` –∏–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≤—ã–≤–æ–¥–∞. –í–æ–∑–º–æ–∂–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å debounce (–∑–∞–¥–µ—Ä–∂–∫–∞ –ø–æ–∏—Å–∫–∞ –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞) –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ SearchBar.js:**
```js
"use client";
import { useState, useEffect } from "react";
import { motion, AnimatePresence } from "framer-motion";
import { Input } from "@/components/ui/input";
import { useUIStore } from "@/store/uiStore";
import { useTags } from "@/hooks/useTags";
import TagBadge from "@/components/TagBadge";
import { cn } from "@/lib/utils";
/**
 * SearchBar‚ÄØ‚Äî‚ÄØ–ø–æ–ª–µ –≤–≤–æ–¥–∞ + —Å–ø–∏—Å–æ–∫ —Ç–µ–≥–æ–≤‚Äë—Ñ–∏–ª—å—Ç—Ä–æ–≤.
 *
 * ‚Ä¢¬†–î–∞–Ω–Ω—ã–µ –≤–≤–æ–¥–∞ ‚Üí¬†Zustand¬†(`searchQuery`) c¬†debounce¬†=¬†1‚ÄØ—Å–µ–∫.  
 * ‚Ä¢¬†–¢–µ–≥–∏ –≥—Ä—É–∑—è—Ç—Å—è —á–µ—Ä–µ–∑ useTags() –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–æ–¥ –∏–Ω–ø—É—Ç–æ–º.  
 * ‚Ä¢¬†–ö–ª–∏–∫ –ø–æ¬†—Ç–µ–≥—É –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –µ–≥–æ –≤¬†Zustand (`toggleTag` –≤–Ω—É—Ç—Ä–∏ TagBadge).  
 *
 * @param placeholder ‚Äì –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä —Å—Ç—Ä–æ–∫–∏ –ø–æ–∏—Å–∫–∞
 */
export default function SearchBar({
  placeholder = "–ü–æ–∏—Å–∫ –ª–æ–∫–∞—Ü–∏–π‚Ä¶",
  className,
}) {
  /* ---------- –≥–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ (Zustand) ---------- */
  const searchQuery = useUIStore((s) => s.searchQuery);
  const setSearchQuery = useUIStore((s) => s.setSearchQuery);
  /* ---------- –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–≤–æ–¥–∞ ---------- */
  const [value, setValue] = useState(searchQuery);
  useEffect(() => {
    const id = window.setTimeout(() => {
      if (value !== searchQuery) setSearchQuery(value);
    }, 1000);
    return () => window.clearTimeout(id);
  }, [value, searchQuery, setSearchQuery]);
  /* –µ—Å–ª–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –∏–∑–≤–Ω–µ ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º input */
  useEffect(() => {
    if (searchQuery !== value) setValue(searchQuery);
  }, [searchQuery]);
  /* ---------- —Å–ø–∏—Å–æ–∫ —Ç–µ–≥–æ–≤ ---------- */
  const { data: tags = [], isLoading, isError } = useTags();

  return (
    <motion.div
      initial={{ y: -8, opacity: 0 }}
      animate={{ y: 0, opacity: 1 }}
      exit={{ y: -8, opacity: 0 }}
      transition={{ duration: 0.25, ease: "easeOut" }}
      className={cn("w-full space-y-3", className)}
    >
      {/* —Å—Ç—Ä–æ–∫–∞ –ø–æ–∏—Å–∫–∞ */}
      <Input
        type="search"
        value={value}
        onChange={(e) => setValue(e.target.value)}
        placeholder={placeholder}
        aria-label="–ü–æ–ª–µ –ø–æ–∏—Å–∫–∞ –ª–æ–∫–∞—Ü–∏–π"
        className="w-full"
      />
      {/* –±–ª–æ–∫ —Ç–µ–≥–æ–≤ */}
      <AnimatePresence initial={false}>
        {/** –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–µ–≥‚Äë–±–∞—Ä –¥–∞–∂–µ –∫–æ–≥–¥–∞ –∏–¥—ë—Ç –∑–∞–≥—Ä—É–∑–∫–∞, —á—Ç–æ–±—ã –≤—ã—Å–æ—Ç–∞ –±—ã–ª–∞ —Å—Ç–∞–±–∏–ª—å–Ω–∞ */}
        <motion.div
          key="tag-bar"
          initial={{ height: 0, opacity: 0 }}
          animate={{ height: "auto", opacity: 1 }}
          exit={{ height: 0, opacity: 0 }}
          transition={{ duration: 0.2 }}
        >
          <div className="flex flex-wrap gap-2 pt-1">
            {isLoading && (
              <span className="text-sm text-muted-foreground">
                –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–≥–∏‚Ä¶
              </span>
            )}
            {isError && (
              <span className="text-sm text-destructive-foreground">
                –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ–≥–∏
              </span>
            )}
            {tags.map((tag) => (
              <TagBadge key={tag.id} name={tag.name} />
            ))}
          </div>
        </motion.div>
      </AnimatePresence>
    </motion.div>
  );
}
```

---
### AddLocationButton

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Ñ–æ—Ä–º–µ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –ª–æ–∫–∞—Ü–∏–∏.
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ù–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ä–∞—Å–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –≤ —É–¥–æ–±–Ω–æ–º –º–µ—Å—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —à–∞–ø–∫–µ –∏–ª–∏ —Å–Ω–∏–∑—É). –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –Ω–∞ –º–∞—Ä—à—Ä—É—Ç `/locations/new`. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Next.js `<Link>` –∏–ª–∏ `useRouter().push`. –ú–æ–∂–µ—Ç –±—ã—Ç—å –≤—Å–µ–≥–¥–∞ –≤–∏–¥–∏–º–æ–π –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (fixed position).
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ AddLocationButton.js:**
```js
"use client";
import Link from "next/link";
import { Plus } from "lucide-react";
import { Button } from "@/components/ui/button";
import { useAuth } from "@/hooks/useAuth";
/**
 * –ü–ª–∞–≤–∞—é—â–∞—è –∫–Ω–æ–ø–∫–∞ ¬´–î–æ–±–∞–≤–∏—Ç—å –ª–æ–∫–∞—Ü–∏—é¬ª.
 * ‚Ä¢ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –≤ –ø—Ä–∞–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É –Ω–∞ –≤—Å–µ—Ö –±—Ä–µ–π–∫–ø–æ–∏–Ω—Ç–∞—Ö;
 * ‚Ä¢ —Å–∫—Ä—ã—Ç–∞ –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π.
 */
export default function AddLocationButton({ className = "" }) {
  const { user } = useAuth();
  if (!user) return null;

  return (
    <Button
      asChild
      className={`fixed bottom-4 right-4 z-50 flex items-center gap-2 ${className}`}
      aria-label="–î–æ–±–∞–≤–∏—Ç—å –ª–æ–∫–∞—Ü–∏—é"
    >
      <Link href="/locations/new">
        <Plus className="w-4 h-4" aria-hidden="true" />
        <span className="sr-only md:not-sr-only">–î–æ–±–∞–≤–∏—Ç—å –ª–æ–∫–∞—Ü–∏—é</span>
      </Link>
    </Button>
  );
}
```

---
### FavouriteFilterButton

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ `LocationList`–ø–æ –∏–∑–±—Ä–∞–Ω–Ω–æ–º—É.
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ù–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ä–∞—Å–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è —Å–Ω–∏–∑—É —Å–ª–µ–≤–∞. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –æ–±–Ω–æ–≤–ª—è–µ—Ç `uiStore`. D—Å–µ–≥–¥–∞ –≤–∏–¥–∏–º—ã–π –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (fixed position).
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ FavouriteFilterButton.js:**
```js
'use client';
import { Star } from 'lucide-react';
import { motion } from 'framer-motion';
import { Button } from '@/components/ui/button';
import { useAuth } from '@/hooks/useAuth';
import { useUIStore } from '@/store/uiStore';
import { cn } from '@/lib/utils';

export default function FavouriteFilterButton({ className = '' }) {
  // 1) —Ö—É–∫–∏ –≤—Å–µ–≥–¥–∞ –Ω–∞ —Å–∞–º–æ–º –≤–µ—Ä—Ö—É
  const { user } = useAuth();
  const showOnlyFavourites = useUIStore((s) => s.showOnlyFavourites);
  const toggle = useUIStore((s) => s.toggleShowOnlyFavourites);
  // 2) —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ ‚Äî —Ä–∞–Ω–Ω–∏–π return –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö
  if (!user) {
    return null;
  }

  return (
    <motion.div
      initial={{ scale: 0, opacity: 0 }}
      animate={{ scale: 1, opacity: 1 }}
      transition={{ type: 'spring', stiffness: 260, damping: 20 }}
      className={cn('fixed bottom-4 left-4 z-50', className)}
    >
      <Button
        variant={showOnlyFavourites ? 'secondary' : 'outline'}
        size="icon"
        aria-label={
          showOnlyFavourites
            ? '–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –ª–æ–∫–∞—Ü–∏–∏'
            : '–ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ'
        }
        onClick={toggle}
        className="rounded-full shadow-lg"
      >
        <Star
          className="h-5 w-5"
          stroke="currentColor"
          fill={showOnlyFavourites ? 'currentColor' : 'none'}
        />
      </Button>
    </motion.div>
  );
}
```

---
### LocationList (—Å–ø–∏—Å–æ–∫ –ª–æ–∫–∞—Ü–∏–π)

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∫–∞—Ä—Ç–æ—á–µ–∫ –ª–æ–∫–∞—Ü–∏–π —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π –ø—Ä–æ–∫—Ä—É—Ç–∫–∏.
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** 
  * –ü—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –≤—ã–∑—ã–≤–∞–µ—Ç useLocations()‚ÄØ(useInfiniteQuery) –∏ –ø–æ–ª—É—á–∞–µ—Ç –ª–æ–∫–∞—Ü–∏–∏, –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ searchQuery‚ÄØ–∏ selectedTags –∏–∑ Zustand.
  * –ü—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ –¥–æ –∫–æ–Ω—Ü–∞ —Å–ø–∏—Å–∫–∞ –≤—ã–∑—ã–≤–∞–µ—Ç fetchNextPage() –¥–ª—è –ø–æ–¥–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö (infinite scroll).
  * –í–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç SkeletonCard. –î–ª—è –∫–∞–∂–¥–æ–π –ª–æ–∫–∞—Ü–∏–∏ —Ä–µ–Ω–¥–µ—Ä–∏—Ç LocationCard.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ LocationList:**
```js
"use client";
import React, { useEffect } from "react";
import { useInView } from "react-intersection-observer";
import { useQueryClient } from "@tanstack/react-query";
import { supabase } from "@/lib/supabaseClient";
import { useLocations } from "@/hooks/useLocations";
import SkeletonCard from "@/components/SkeletonCard";
import LocationCard from "@/components/LocationCard";
/**
 * LocationList ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–ø–∏—Å–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫ –ª–æ–∫–∞—Ü–∏–π.
 *
 * ‚Ä¢ –ë–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ (useInfiniteQuery¬†+¬†Intersection¬†Observer).
 * ‚Ä¢ Realtime‚Äë–ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ INSERT‚ÄØ/‚ÄØUPDATE‚ÄØ/‚ÄØDELETE –≤¬†—Ç–∞–±–ª–∏—Ü–µ `locations`.
 *   ‚ó¶ INSERT¬†‚Äî –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ–º –∫—ç—à, —á—Ç–æ–±—ã –ø–æ–¥—Ç—è–Ω—É—Ç—å –Ω–æ–≤—É—é –ª–æ–∫–∞—Ü–∏—é.
 *   ‚ó¶ UPDATE¬†‚Äî –ø–∞—Ç—á–∏–º —ç–ª–µ–º–µ–Ω—Ç –≤¬†–∫—ç—à–µ –±–µ–∑ –ø–æ–ª–Ω–æ–≥–æ —Ä–µ—Ñ–µ—Ç—á–∞.
 *   ‚ó¶ DELETE¬†‚Äî —É–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –∏–∑¬†–∫—ç—à–∞.
 */
export default function LocationList() {
  const {
    data,
    isLoading,
    isError,
    fetchNextPage,
    hasNextPage,
    isFetchingNextPage,
  } = useLocations();

  const { ref, inView } = useInView();
  const queryClient = useQueryClient();

  /* ---------- Infinite¬†Scroll ---------- */
  useEffect(() => {
    if (inView && hasNextPage) {
      fetchNextPage();
    }
  }, [inView, hasNextPage, fetchNextPage]);

  /* ---------- Realtime¬†subscription ---------- */
  useEffect(() => {
    const channel = supabase
      .channel("realtime:locations-changes")
      // INSERT ‚Äî –ø—Ä–æ—Å—Ç–æ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ–º, —á—Ç–æ–±—ã –¥–æ—à–ª–∏ –Ω–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏
      .on(
        "postgres_changes",
        { event: "INSERT", schema: "public", table: "locations" },
        () => {
          queryClient.invalidateQueries({ queryKey: ["locations"] });
        }
      )
      // UPDATE ‚Äî —Ç–æ—á–µ—á–Ω–æ –ø–∞—Ç—á–∏–º –∫—ç—à, –∏–∑–±–µ–≥–∞—è –ø–æ–ª–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
      .on(
        "postgres_changes",
        { event: "UPDATE", schema: "public", table: "locations" },
        ({ new: newRow }) => {
          queryClient.setQueriesData({ queryKey: ["locations"] }, (old) => {
            if (!old) return old;
            return {
              ...old,
              pages: old.pages.map((page) => ({
                ...page,
                items: page.items.map((item) =>
                  item.id === newRow.id ? { ...item, ...newRow } : item
                ),
              })),
            };
          });
        }
      )
      // DELETE ‚Äî —É–¥–∞–ª—è–µ–º –∫–∞—Ä—Ç–æ—á–∫—É –∏–∑¬†–∫—ç—à–∞
      .on(
        "postgres_changes",
        { event: "DELETE", schema: "public", table: "locations" },
        ({ old: oldRow }) => {
          queryClient.setQueriesData({ queryKey: ["locations"] }, (old) => {
            if (!old) return old;
            return {
              ...old,
              pages: old.pages.map((page) => ({
                ...page,
                items: page.items.filter((item) => item.id !== oldRow.id),
              })),
            };
          });
        }
      )
      .subscribe();

    return () => {
      supabase.removeChannel(channel);
    };
  }, [queryClient]);

  /* ---------- Render ---------- */
  if (isLoading) {
    return (
      <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
        {[...Array(6)].map((_, idx) => (
          <SkeletonCard key={idx} />
        ))}
      </div>
    );
  }

  if (isError) {
    return <div className="text-red-500">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–∫–∞—Ü–∏–π</div>;
  }

  return (
    <>
      <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
        {data.pages.map((page) =>
          page.items.map((location) => (
            <LocationCard key={location.id} location={location} />
          ))
        )}
      </div>
      <div ref={ref} className="py-8 text-center">
        {isFetchingNextPage
          ? "–ó–∞–≥—Ä—É–∑–∫–∞..."
          : hasNextPage
          ? "–ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–æ–≤—ã—Ö"
          : "–ë–æ–ª—å—à–µ –Ω–µ—Ç –ª–æ–∫–∞—Ü–∏–π"}
      </div>
    </>
  );
}
```

---
### `route.js`¬†‚Äî NextAuth‚Äë—ç–Ω–¥–ø–æ–∏–Ω—Ç `app/api/auth/[...nextauth]/route.js`
* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ HTTP‚Äë–∑–∞–ø—Ä–æ—Å—ã NextAuth (`GET`, `POST`) –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç password‚Äëless‚ÄØ–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é —á–µ—Ä–µ–∑ Credentials Provider. –°–æ–∑–¥–∞—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ç–∞–±–ª–∏—Ü–µ `users`, –µ—Å–ª–∏ —Ç–æ—Ç –≤—Ö–æ–¥–∏—Ç –≤–ø–µ—Ä–≤—ã–µ.
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:**
  * –ü—Ä–∏ `authorize()` –∞–ø—Å—ë—Ä—Ç–∏—Ç –ª–æ–≥–∏–Ω –≤ Supabase `users`.
  * –í callback‚Äô–∞—Ö –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ—Ç `token.id` ‚Üí `session.user.id`, —á—Ç–æ–±—ã RLS‚Äë–ø–æ–ª–∏—Ç–∏–∫–∏ ¬´–∑–Ω–∞–ª–∏¬ª —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å–º. DataModel‚ÄëBatumiTrip.md ¬ß‚ÄØ5).
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ route.js:**
```js
import NextAuth from 'next-auth';
import CredentialsProvider from 'next-auth/providers/credentials';
import { supabase } from '@/lib/supabaseClient';

export const authOptions = {
  providers: [
    CredentialsProvider({
      name: 'Login',
      credentials: {
        username: { label: '–õ–æ–≥–∏–Ω', type: 'text', placeholder: 'ivan' },
      },
      async authorize(creds) {
        const username = creds?.username?.trim();
        const re = /^[A-Za-z\u0400-\u04FF]{3,32}$/; // –¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Å–∏–º–≤–æ–ª—ã

        if (!username || !re.test(username)) return null;

        const { error } = await supabase
          .from('users')
          .upsert({ id: username }, { onConflict: 'id' });

        if (error) {
          console.error('Supabase upsert error', error);
          return null;
        }
        return { id: username };
      },
    }),
  ],

  session: { strategy: 'jwt', maxAge: 60 * 60 * 24 * 30 }, // 30¬†–¥–Ω–µ–π

  callbacks: {
    jwt: ({ token, user }) => {
      if (user?.id) token.id = user.id;
      return token;
    },
    session: ({ session, token }) => {
      if (token?.id) session.user = { id: token.id };
      return session;
    },
  },

  pages: { signIn: '/' },      // –æ—Å—Ç–∞—ë–º—Å—è –Ω–∞ / ‚Äî LoginModal –≤—Å—ë –ø–µ—Ä–µ–∫—Ä–æ–µ—Ç
  secret: process.env.NEXTAUTH_SECRET,
};

const handler = NextAuth(authOptions);
export { handler as GET, handler as POST };
```

---
### AuthProvider.js
* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç React‚Äë–¥–µ—Ä–µ–≤–æ –≤ `<SessionProvider>`, –ø–µ—Ä–µ–¥–∞–≤–∞—è –≤–Ω–∏–∑ –¥–∞–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏ NextAuth.&#x20;
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ `Providers.js`; –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ `useSession()` –≤–æ –≤—Å–µ—Ö –¥–æ—á–µ—Ä–Ω–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ AuthProvider.js:**
```js
'use client';
import { SessionProvider } from 'next-auth/react';

export default function AuthProvider({ children }) {
  return <SessionProvider>{children}</SessionProvider>;
}
```
---
### LoginModal.js

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∏–∞–ª–æ–≥ —Å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–≤—ã–º –ø–æ–ª–µ–º –¥–ª—è –ª–æ–≥–∏–Ω–∞ –∏ –∫–Ω–æ–ø–∫–æ–π ¬´–í–æ–π—Ç–∏¬ª. –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç `signIn('credentials')`.
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:**
  * –ß–∏—Ç–∞–µ—Ç `showLoginModal` –∏ `setLoginModal` –∏–∑ Zustand.
  * –ü–æ `onSubmit` –≤—ã–∑—ã–≤–∞–µ—Ç `signIn`, –∑–∞—Ç–µ–º –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª–∫—É.
  * –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏/–∑–∞–∫—Ä—ã—Ç–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã `Dialog*` –∏–∑ **shadcn**.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ LoginModal.js:**
```js
"use client";
import { useState, useEffect, useCallback } from "react";
import { signIn, useSession } from "next-auth/react";
import { useUIStore } from "@/store/uiStore";
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
  DialogFooter,
  DialogOverlay,
  DialogPortal,
} from "@/components/ui/dialog";
import { Input } from "@/components/ui/input";
import { Button } from "@/components/ui/button";
import { motion, AnimatePresence } from "framer-motion";
import dynamic from "next/dynamic";
import animationData from "@/public/loginAnimation.json";
// ---------- lazy‚Äë–∑–∞–≥—Ä—É–∑–∫–∞ Lottie ----------
const Lottie = dynamic(() => import("lottie-react"), { ssr: false });

export default function LoginModal() {
  /* ----- –≥–ª–æ–±–∞–ª—å–Ω—ã–π UI‚Äëstate (Zustand) ----- */
  const show = useUIStore((s) => s.showLoginModal);
  const setShow = useUIStore((s) => s.setLoginModal);
  /* ----- auth‚Äë—Å—Ç–∞—Ç—É—Å ----- */
  const { status } = useSession();
  /* ----- –ª–æ–∫–∞–ª—å–Ω—ã–π —Å—Ç—ç–π—Ç —Ñ–æ—Ä–º—ã ----- */
  const [login, setLogin] = useState("");
  const [error, setError] = useState("");
  const [isSubmitting, setSubmitting] = useState(false);
  const [focused, setFocused] = useState(false);
  /* ----- –∞–≤—Ç–æ–ø–æ–∫–∞–∑, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω ----- */
  useEffect(() => {
    if (status === "unauthenticated" && !show) setShow(true);
  }, [status, show, setShow]);
  /* ----- –∑–∞–∫—Ä—ã—Ç—å –ú–û–î–ê–õ–ö–£ —Ç–æ–ª—å–∫–æ –ü–û–°–õ–ï —É—Å–ø–µ—à–Ω–æ–≥–æ –ª–æ–≥–∏–Ω–∞ ----- */
  useEffect(() => {
    if (status === "authenticated") setShow(false);
  }, [status, setShow]);
  /* ----- –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã ----- */
  const handleSubmit = async (e) => {
    e.preventDefault();
    const trimmed = login.trim();
    const re = /^[A-Za-z\u0400-\u04FF]{3,32}$/; // 3‚Äì32¬†–±—É–∫–≤—ã (–ª–∞—Ç/–∫–∏—Ä–∏–ª–ª)
    if (!re.test(trimmed)) {
      setError("–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è: 3‚Äì32 —Å–∏–º–≤–æ–ª–∞, —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã.");
      return;
    }
    setError("");
    setSubmitting(true);
    await signIn("credentials", { username: trimmed, redirect: false });
    setSubmitting(false);
  };
  /* ----- —Ñ–∏–ª—å—Ç—Ä—É–µ–º onOpenChange, –∑–∞–ø—Ä–µ—â–∞—è –∑–∞–∫—Ä—ã–≤–∞—Ç—å –æ–∫–Ω–æ ----- */
  const handleOpenChange = useCallback(
    /** @param {boolean} next */ (next) => {
      if (next) setShow(true); // permit only attempts to OPEN, ignore close
    },
    [setShow]
  );

  return (
    <AnimatePresence>
      {show && (
        <Dialog open={show} onOpenChange={handleOpenChange}>
          <DialogPortal>
            {/* —Ä–∞–∑–º—ã—Ç—ã–π —Ñ–æ–Ω –≤–º–µ—Å—Ç–æ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏—è */}
            <DialogOverlay className="fixed inset-0 bg-background/30 backdrop-blur-sm" />

            <DialogContent
              /* —Å–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∫—Ä–µ—Å—Ç–∏–∫ –≤–Ω—É—Ç—Ä–∏ Content */
              className="w-full max-w-sm overflow-hidden rounded-xl bg-card text-card-foreground shadow-lg [&>button]:hidden"
            >
              <motion.div
                initial={{ opacity: 0, scale: 0.95 }}
                animate={{ opacity: 1, scale: 1 }}
                exit={{ opacity: 0, scale: 0.95 }}
                transition={{ duration: 0.4 }}
              >
                {/* ---------- Header ---------- */}
                <DialogHeader className="flex flex-col items-center px-6 pt-6">
                  <motion.div
                    initial={{ scale: 0.5, opacity: 0.1 }}
                    animate={{ scale: 1.8, opacity: 1 }}
                    transition={{ duration: 6 }}
                    className="mb-4 h-24 w-24"
                  >
                    <Lottie animationData={animationData} loop autoplay />
                  </motion.div>

                  <DialogTitle className="text-center text-xl font-semibold">
                    –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
                  </DialogTitle>
                  <p className="mt-2 text-center text-sm italic text-muted-foreground">
                    –ë—ã–≤–∞–ª–∏ –∑–¥–µ—Å—å —Ä–∞–Ω—å—à–µ? –í–≤–µ–¥–∏—Ç–µ —Ç–æ –∂–µ –ò–º—è. <br /> –û–Ω–æ —Å–≤—è–∑–∞–Ω–æ —Å
                    –í–∞—à–∏–º–∏ –ª–æ–∫–∞—Ü–∏—è–º–∏.
                  </p>
                </DialogHeader>
                {/* ---------- Form ---------- */}
                <form
                  onSubmit={handleSubmit}
                  className="space-y-4 px-6 pb-6 pt-4"
                  aria-label="–§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞"
                >
                  <Input
                    id="username"
                    placeholder="–ü–æ–∑–Ω–∞–∫–æ–º–∏–º—Å—è?"
                    autoComplete="username"
                    onFocus={() => setFocused(true)}
                    onBlur={() => setFocused(false)}
                    className="peer"
                    value={login}
                    onChange={(e) => setLogin(e.target.value)}
                    required
                  />

                  <AnimatePresence>
                    {error && (
                      <motion.div
                        initial={{ height: 0, opacity: 0 }}
                        animate={{ height: "auto", opacity: 1 }}
                        exit={{ height: 0, opacity: 0 }}
                        transition={{ duration: 0.3 }}
                        className="overflow-hidden rounded border border-red-300 bg-red-100 p-2 text-sm text-red-800"
                      >
                        {error}
                      </motion.div>
                    )}
                  </AnimatePresence>

                  <DialogFooter>
                    <Button type="submit" className="w-full" disabled={isSubmitting}>
                      {isSubmitting ? "–í—Ö–æ–¥–∏–º‚Ä¶" : "–í–æ–π—Ç–∏"}
                    </Button>
                  </DialogFooter>
                </form>
              </motion.div>
            </DialogContent>
          </DialogPortal>
        </Dialog>
      )}
    </AnimatePresence>
  );
}
```

---
### LocationCard

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–∞—Ä—Ç–æ—á–∫–∞-–ø—Ä–µ–≤—å—é –ª–æ–∫–∞—Ü–∏–∏, –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–∞—è –∫—Ä–∞—Ç–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –∑–∞–≥–æ–ª–æ–≤–æ–∫, —á–∞—Å—Ç—å –æ–ø–∏—Å–∞–Ω–∏—è, —Ç–µ–≥–∏, —Å—Ç–æ–∏–º–æ—Å—Ç—å). –ü—Ä–∏ –∫–ª–∏–∫–µ –≤–µ–¥–µ—Ç –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ª–æ–∫–∞—Ü–∏–∏.
* **–ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã:** –ü–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–µ –ø—Ä–æ–ø—Å—ã —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –∏–∑ –¥–∞–Ω–Ω—ã—Ö API (Supabase) –ø–æ —Ç–∞–±–ª–∏—Ü–µ `locations` —Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ–º —Ç–µ–≥–æ–≤.
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** 
  * –ü—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–∞—Ä—Ç–∏–Ω–∫—É (—Å –æ–±—Ä–µ–∑–∫–æ–π –ø–æ —Ä–∞–∑–º–µ—Ä—É), –∑–∞–≥–æ–ª–æ–≤–æ–∫, –ø–µ—Ä–≤—ã–µ 2‚Äì3 —Å—Ç—Ä–æ–∫–∏ –æ–ø–∏—Å–∞–Ω–∏—è –∏ `TagBadge` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ–≥–∞, –∏–∫–æ–Ω–∫—É `–∏–∑–±—Ä–∞–Ω–Ω–æ–µ`‚≠ê‚ÄØ(filled‚ÄØ/‚ÄØoutline).
  * –ü—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–∞—Ä—Ç–æ—á–∫–∞ –º–æ–∂–µ—Ç —Å–ª–µ–≥–∫–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏–ª–∏ –ø–æ—è–≤–ª—è—Ç—å—Å—è —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π Framer Motion (–ø–æ–≤—ã—à–µ–Ω–Ω—ã–π UX). –ü–æ –∫–ª–∏–∫—É –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É –∏–ª–∏ –∫–Ω–æ–ø–∫—É "–ü–æ–¥—Ä–æ–±–Ω–µ–µ" –≤—ã–∑—ã–≤–∞–µ—Ç `router.push('/locations/${id}')`.
  * –ö–ª–∏–∫ –ø–æ –∏–∫–æ–Ω–∫–µ –≤—ã–∑—ã–≤–∞–µ—Ç —Ö—É–∫ useToggleFavourite(id) ‚Üí
  ‚Äì –µ—Å–ª–∏ –Ω–µ –±—ã–ª–æ¬†–ª—é–±–∏–º–æ, POST /rest/v1/favourites (–∏–ª–∏ RPC¬†add_favourite)
  ‚Äì –µ—Å–ª–∏ –±—ã–ª–æ, DELETE /rest/v1/favourites?user_id=eq.{uid}&location_id=eq.{id}. –•—É–∫ –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç favourites –≤‚ÄØZustand –∏ invalidates ['favourites', userId].
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ LocationCard:**:
```js
"use client";
import React, { memo } from "react";
import Link from "next/link";
import Image from "next/image";
import { Star } from "lucide-react";
import { motion } from "framer-motion";
import TagBadge from "@/components/TagBadge";
import { useUIStore } from "@/store/uiStore";
import { useAuth } from "@/hooks/useAuth";
import { cn } from "@/lib/utils";
import { useToggleFavourite } from "@/hooks/useToggleFavourite";
/**
 * LocationCard ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞‚Äë–ø—Ä–µ–≤—å—é –ª–æ–∫–∞—Ü–∏–∏.
 * ‚Ä¢¬†–ò–∫–æ–Ω–∫–∞ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –ø–æ–¥ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Äî –≤—ã—Ä–∞–≤–Ω–µ–Ω–∞
 *   –ø–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é –∑–∞–≥–æ–ª–æ–≤–∫–∞ (flex‚Äë–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä).  
 * ‚Ä¢¬†–ó–∞–≥–æ–ª–æ–≤–æ–∫ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–≤—É–º—è —Å—Ç—Ä–æ–∫–∞–º–∏ —á–µ—Ä–µ–∑ `line-clamp-2`.
 * ‚Ä¢¬†–§–æ–Ω –∫–∞—Ä—Ç–æ—á–∫–∏ ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `card`, —Ç–µ–∫—Å—Ç ‚Äî `card-foreground`.
 */
const LocationCard = ({ location }) => {
  const {
    id,
    title,
    description,
    imgUrl,
    tags = [],
    isFavourite: initialFavourite = false,
  } = location;
  /* ---------- global UI state ---------- */
  const selectedTags = useUIStore((s) => s.selectedTags);
  const favouritesMap = useUIStore((s) => s.favourites);
  const showOnlyFavourites = useUIStore((s) => s.showOnlyFavourites);
  const isFavourite = favouritesMap[id] ?? initialFavourite;
  /* ---------- auth ---------- */
  const { user } = useAuth();
  /* tag‚Äëfilter + ¬´only favourites¬ª filter */
  const matchesFilter =
    (!showOnlyFavourites || isFavourite) &&
    (selectedTags.length === 0 ||
      selectedTags.every((tag) => tags.includes(tag)));
  /* optimistic toggle favourite */
  const toggleFavourite = useToggleFavourite(id);
  /* fallback image */
  const imageSrc =
    imgUrl && /^https?:\/\//.test(imgUrl)
      ? imgUrl
      : "https://cataas.com/cat/gif";

  if (!matchesFilter) return null;

  return (
    <motion.div
      layout
      whileHover={{ scale: 1.02 }}
      className="group relative rounded-2xl bg-card text-card-foreground p-4 shadow transition-shadow"
    >
      {/* —Å—Å—ã–ª–∫–∞ –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –æ–±–ª–∞—Å—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ */}
      <Link href={`/locations/${id}`} className="block no-underline hover:no-underline focus:no-underline">
        <Image
          src={imageSrc}
          alt={title}
          width={400}
          height={240}
          className="h-40 w-full rounded-lg object-cover"
        />
        {/* ---------- Header: title & favourite ---------- */}
        <div className="mt-4 flex items-start justify-between gap-2">
          <h3 className="flex-1 text-lg font-semibold line-clamp-2 text-white">
            {title}
          </h3>
          {/* –∑–≤–µ–∑–¥–∞ ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö */}
          {user && (
            <button
              type="button"
              onClick={(e) => {
                e.preventDefault();
                toggleFavourite();
              }}
              aria-label={
                isFavourite ? "–£–±—Ä–∞—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ" : "–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ"
              }
              className={cn(
                "rounded-full p-2 transition-colors focus:outline-none focus:ring-2 focus:ring-ring",
                isFavourite
                  ? "text-yellow-500"
                  : "text-gray-400 hover:text-yellow-500"
              )}
            >
              <Star
                size={20}
                stroke="currentColor"
                fill={isFavourite ? "currentColor" : "none"}
              />
            </button>
          )}
        </div>
        {/* ---------- Description ---------- */}
        <p className="mt-2 text-sm text-muted-foreground line-clamp-3">
          {description}
        </p>
      </Link>
      {/* ---------- Tags ---------- */}
      {tags.length > 0 && (
        <div className="mt-3 flex flex-wrap gap-2">
          {tags.map((tag) => (
            <TagBadge key={tag} name={tag} />
          ))}
        </div>
      )}
    </motion.div>
  );
};
export default memo(LocationCard);
```

---
### LocationDetail

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ª–æ–∫–∞—Ü–∏–∏ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞ `LocationDetailPage`).
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–æ–ª—å—à–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –≤—Å–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è –ª–æ–∫–∞—Ü–∏–∏. –¢–µ–≥–∏ –≤—ã–≤–æ–¥–∏—Ç —á–µ—Ä–µ–∑ `TagBadge`. –ö–Ω–æ–ø–∫–∏ `EditButton` –∏ `DeleteButton` (—Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Ç–µ–º –∂–µ `id`) —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é—Ç—Å—è —Ä—è–¥–æ–º. –ê–¥—Ä–µ—Å –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–º (—Å—Å—ã–ª–∫–∞ –Ω–∞ Google Maps), `sourceUrl` ‚Äî –≤–Ω–µ—à–Ω–∏–π —Ä–µ—Å—É—Ä—Å.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ LocationDetail:**
```js
'use client';
import Image from 'next/image';
import { motion } from 'framer-motion';
import { Button } from '@/components/ui/button';
import TagBadge from '@/components/TagBadge';
import { useRouter } from 'next/navigation';
/**
 * –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ª–æ–∫–∞—Ü–∏–∏.
 * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–∞—Ä—Ç–æ—á–∫—É –ª–æ–∫–∞—Ü–∏–∏ —Å –¥–µ—Ç–∞–ª—è–º–∏ –∏ –∞–≤—Ç–æ—Ä–æ–º –≤–Ω–∏–∑—É.
 * @param {{ location: import('@/hooks/useOneLocation').Location & { user_id: string }}} props
 */
export default function LocationDetail({ location }) {
  const router = useRouter();
  const {
    title,
    description,
    imgUrl,
    address,
    cost,
    source_url: sourceUrl,
    tags = [],
    user_id: authorId, // –∞–≤—Ç–æ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏
  } = location;
  // –§–æ–ª–±—ç–∫ –¥–ª—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö URL
  const imageSrc =
    imgUrl && /^https?:\/\//.test(imgUrl)
      ? imgUrl
      : 'https://cataas.com/cat/gif';

  return (
    <motion.article
      initial={{ opacity: 0, y: 8 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.25, ease: 'easeOut' }}
      className="space-y-6"
    >
      {/* ---------- –ó–∞–≥–æ–ª–æ–≤–æ–∫ ---------- */}
      <header className="space-y-2">
        <h1 className="text-3xl font-bold break-words">{title}</h1>
      </header>
      {/* ---------- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ---------- */}
      <div className="relative h-60 w-full overflow-hidden rounded-lg shadow">
        <Image
          src={imageSrc}
          alt={title}
          fill
          sizes="(max-width: 768px) 100vw, 768px"
          className="object-cover"
        />
      </div>
      {/* ---------- –ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è ---------- */}
      <section className="space-y-2 text-sm leading-relaxed">
        {address && (
          <p>
            <strong>–ê–¥—Ä–µ—Å:&nbsp;</strong>
            <a
              href={`https://www.google.com/maps/search/${encodeURIComponent(
                address,
              )}`}
              target="_blank"
              rel="noopener noreferrer"
              className="text-primary underline break-words"
            >
              {address}
            </a>
          </p>
        )}
        {cost && (
          <p>
            <strong>–°—Ç–æ–∏–º–æ—Å—Ç—å:&nbsp;</strong>
            {cost}
          </p>
        )}
        {sourceUrl && (
          <p>
            <strong>–ò—Å—Ç–æ—á–Ω–∏–∫:&nbsp;</strong>
            <a
              href={sourceUrl}
              target="_blank"
              rel="noopener noreferrer"
              className="text-primary underline break-all"
            >
              {sourceUrl}
            </a>
          </p>
        )}
      </section>
      {/* ---------- –û–ø–∏—Å–∞–Ω–∏–µ ---------- */}
      {description && (
        <p className="prose dark:prose-invert max-w-none">{description}</p>
      )}
      {/* ---------- –¢–µ–≥–∏ ---------- */}
      {tags.length > 0 && (
        <div className="flex flex-wrap gap-2">
          {tags.map((tag) => (
            <TagBadge key={tag} name={tag} />
          ))}
        </div>
      )}
      {/* ---------- –ê–≤—Ç–æ—Ä ---------- */}
      <div className="flex items-center gap-2">
        <span className="text-base font-medium text-muted-foreground">
          –ê–≤—Ç–æ—Ä:
        </span>
        <span
          className="
            inline-block rounded-md bg-muted 
            px-3 py-1 text-sm font-semibold text-foreground
            select-none
          "
        >
          {authorId}
        </span>
      </div>
      {/* ---------- –ù–∞–≤–∏–≥–∞—Ü–∏—è ---------- */}
      <div className="flex gap-2">
        <Button variant="secondary" onClick={() => router.push('/')}>
          –ù–∞–∑–∞–¥
        </Button>
      </div>
    </motion.article>
  );
}
```

---
### TagBadge

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–∏–∑—É–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Ç–µ–≥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏) –ª–æ–∫–∞—Ü–∏–∏.
* **–ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã:** –ü–æ–ª—É—á–∞–µ—Ç –∏–º—è —Ç–µ–≥–∞ –∏–∑ –¥–∞–Ω–Ω—ã—Ö. –¢–µ–≥–∏ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `tags` –∏–ª–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—Ä–æ—Å —Å–≤—è–∑–µ–π `locations_tags`.
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ª–æ–≤–æ –≤ —Ä–∞–º–∫–µ –∏–ª–∏ –ø–æ–¥–ª–æ–∂–∫–µ (badge), —Å—Ç–∏–ª—å ‚Äî —Ñ–æ–Ω–æ–≤—ã–π —Ü–≤–µ—Ç –∏ —Å–∫—Ä—É–≥–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Tailwind. –ü—Ä–∏ –∫–ª–∏–∫–µ (–µ—Å–ª–∏ –∑–∞–¥–∞–Ω `onClick`) –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ (Zustand), —á—Ç–æ–±—ã –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Ç–µ–≥—É. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ `LocationCard` –∏ `LocationDetail`.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ TagBadge:**
```js
"use client";
import { motion } from "framer-motion";
import { cn } from "@/lib/utils";
import { useUIStore } from "@/store/uiStore";
/**
 * –ë–µ–π–¥–∂‚Äë—Ç–µ–≥, –∫–æ—Ç–æ—Ä—ã–π —Å–∞–º –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä.
 * –í—ã–±—Ä–∞–Ω–Ω—ã–µ —Ç–µ–≥–∏ –±–µ—Ä—ë–º –∏–∑ Zustand, –ø–æ—ç—Ç–æ–º—É –æ—Ç–¥–µ–ª—å–Ω—ã–π
 * prop `onClick` –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω.
 */
export default function TagBadge({ name, className }) {
  // —Å–µ–ª–µ–∫—Ç–æ—Ä —á–µ—Ä–µ–∑ zustand ‚Äî –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã –æ–±—ä–µ–∫—Ç –Ω–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞–ª—Å—è –ª–∏—à–Ω–∏–π —Ä–∞–∑
  const selectedTags =  useUIStore((s) => s.selectedTags);
  const toggleTag = useUIStore((s) => s.toggleTag);
  const isActive = selectedTags.includes(name);

  return (
    <motion.span
      whileHover={{ scale: 1.05 }}
      whileTap={{ scale: 0.95 }}
      onClick={(e) => {
        e.stopPropagation();
        e.preventDefault();
        toggleTag(name);
      }}
      role="button"
      aria-pressed={isActive}
      aria-label={`–§–∏–ª—å—Ç—Ä –ø–æ —Ç–µ–≥—É ¬´${name}¬ª`}
      className={cn(
        // –±–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏
        "inline-flex items-center rounded-full border px-2 py-0.5 text-xs font-medium select-none transition",
        // —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        isActive
          ? "bg-secondary text-secondary-foreground border-secondary"
          : "bg-muted text-muted-foreground border-border hover:bg-secondary/20",
        className
      )}
    >
      {name}
    </motion.span>
  );
}
```
---
### ChooseTag

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞/–¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–µ–≥–æ–≤ –≤–Ω—É—Ç—Ä–∏ LocationForm.
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –í—ã–±—Ä–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ç–µ–≥ –æ–¥–Ω–∏–º –∫–ª–∏–∫–æ–º. –î–æ–±–∞–≤–∏—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–≥, –∫–æ—Ç–æ—Ä–æ–≥–æ –µ—â—ë –Ω–µ—Ç –≤ –±–∞–∑–µ. –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ç–µ–≥–æ–≤ —á–µ—Ä–µ–∑ useTags(); –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å react-hook-form (useController) ‚Üí field.value = string[]; –ü—Ä–∏ –≤–≤–æ–¥–µ –Ω–æ–≤–æ–≥–æ —Ç–µ–≥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç INSERT —á–µ—Ä–µ–∑ Supabase;–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–≤–∞–ª–∏ –¥–∞—Ü–∏—è ['tags'] –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫ –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Ç–µ–≥–∞–º;
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ ChooseTag:**
```js
"use client";
import React, { useState } from "react";
import { useController } from "react-hook-form";
import { useTags } from "@/hooks/useTags";
import { useMutation, useQueryClient } from "@tanstack/react-query";
import { supabase } from "@/lib/supabaseClient";
import { Input } from "@/components/ui/input";
import { Button } from "@/components/ui/button";
import { cn } from "@/lib/utils";
import { motion, AnimatePresence } from "framer-motion";

export default function ChooseTag({ control, name = "tags", rules }) {
  const {
    field: { value: selected = [], onChange },
  } = useController({ control, name, rules });

  const { data: tags = [], isLoading, isError } = useTags();
  const [newTag, setNewTag] = useState("");
  const queryClient = useQueryClient();

  const createTag = useMutation({
    mutationFn: async (name) => {
      const trimmed = name.trim();
      const { data, error } = await supabase
        .from("tags")
        .insert({ name: trimmed })
        .select()
        .single();
      if (error && error.code !== "23505") throw error;
      return data ?? { name: trimmed };
    },
    onSuccess: (data) => {
      queryClient.invalidateQueries(["tags"]);
      if (!selected.includes(data.name)) onChange([...selected, data.name]);
      setNewTag("");
    },
  });

  const toggle = (tag) => {
    if (selected.includes(tag)) onChange(selected.filter((t) => t !== tag));
    else onChange([...selected, tag]);
  };

  const handleAdd = () => {
    const trimmed = newTag.trim();
    if (!trimmed) return;
    const exists = tags.some((t) => t.name.toLowerCase() === trimmed.toLowerCase());
    if (exists) {
      if (!selected.includes(trimmed)) toggle(trimmed);
      setNewTag("");
      return;
    }
    createTag.mutate(trimmed);
  };

  return (
    <div className="space-y-3">
      {/* –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ–≥–∏ */}
      <div className="flex flex-wrap gap-2">
        {isLoading && <span className="text-sm text-muted-foreground">–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–≥–æ–≤‚Ä¶</span>}
        {isError && <span className="text-sm text-destructive-foreground">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ–≥–æ–≤</span>}
        {tags.map((tag) => (
          <motion.span
            key={tag.id}
            whileTap={{ scale: 0.95 }}
            role="button"
            aria-pressed={selected.includes(tag.name)}
            onClick={() => toggle(tag.name)}
            className={cn(
              "inline-flex items-center rounded-full border px-2 py-0.5 text-xs font-medium select-none transition cursor-pointer",
              selected.includes(tag.name)
                ? "bg-secondary text-secondary-foreground border-secondary"
                : "bg-muted text-muted-foreground border-border hover:bg-secondary/20"
            )}
          >
            {tag.name}
          </motion.span>
        ))}
      </div>

      {/* –î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–π —Ç–µ–≥ */}
      <div className="flex gap-2" role="form">
        <Input
          value={newTag}
          onChange={(e) => setNewTag(e.target.value)}
          placeholder="–î–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥‚Ä¶"
          aria-label="–ù–æ–≤—ã–π —Ç–µ–≥"
          className="flex-1"
          onKeyDown={(e) => e.key === 'Enter' && (e.preventDefault(), handleAdd())}
        />
        <Button type="button" disabled={createTag.isLoading || !newTag.trim()} onClick={handleAdd}>
          {createTag.isLoading ? "‚Ä¶" : "–î–æ–±–∞–≤–∏—Ç—å"}
        </Button>
      </div>

      {/* –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ–≥–∞ */}
      <AnimatePresence>
        {createTag.isError && (
          <motion.div
            initial={{ opacity: 0, height: 0 }}
            animate={{ opacity: 1, height: 'auto' }}
            exit={{ opacity: 0, height: 0 }}
            className="overflow-hidden text-sm text-destructive-foreground"
          >
            –û—à–∏–±–∫–∞: {createTag.error?.message || '–Ω–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥'}
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
}
```
---
### AttachImage

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ `LocationForm`
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:**
  * –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–±—Ä–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.
  * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
  * –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.
  * –û—á–∏—â–∞–µ—Ç —Å—Å—ã–ª–∫—É URL.createObjectURL, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ AttachImage.js:**
```js
'use client';
import React, { useEffect, useRef, useState } from "react";
import { useController } from "react-hook-form";
import { Upload, X } from "lucide-react";
import { cn } from "@/lib/utils";
/**
* @param {Object}   props
* @param {string?}  [props.initialUrl] ‚Äì URL —É–∂–µ¬†–∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
*/
// –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π AttachImage: —Å–æ—Ö—Ä–∞–Ω—è–µ–º –æ–¥–∏–Ω File –≤–º–µ—Å—Ç–æ FileList
export default function AttachImage({ control, name = "imageFile", rules, initialUrl = null, className }) {
  const inputRef = useRef(null);
  const [preview, setPreview] = useState(initialUrl);

  const {
    field: { value, onChange, ref },
    fieldState: { error },
  } = useController({ control, name, rules });

  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–¥–∏–Ω File, –∞ –Ω–µ FileList
  const handleSelect = (e) => {
    const files = e.target.files;
    if (!files || files.length === 0) return;

    const file = files[0];
    onChange(file);
    const url = URL.createObjectURL(file);
    setPreview(url);
  };

  const handleRemove = () => {
    if (preview?.startsWith("blob:")) URL.revokeObjectURL(preview);
    setPreview(null);
    onChange(null);
    if (inputRef.current) inputRef.current.value = "";
  };

  // –û—á–∏—â–∞–µ–º preview –ø—Ä–∏ unmount
  useEffect(() => {
    return () => {
      if (preview?.startsWith("blob:")) URL.revokeObjectURL(preview);
    };
  }, [preview]);

  return (
    <div className={cn("space-y-2", className)}>
      {!preview && (
        <label
          className="flex flex-col items-center justify-center w-full max-w-xs gap-2 rounded-lg border-2 border-dashed border-border p-6 cursor-pointer text-sm text-muted-foreground hover:bg-muted/30 focus:outline-none focus:ring-2 focus:ring-ring"
          aria-label="–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"
        >
          <Upload className="h-6 w-6" aria-hidden="true" />
          <span>–ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å —Ñ–æ—Ç–æ</span>
          <input
            type="file"
            accept="image/*"
            ref={(el) => {
              ref(el);
              inputRef.current = el;
            }}
            onChange={handleSelect}
            className="sr-only"
          />
        </label>
      )}
      {preview && (
        <div className="relative w-full max-w-xs">
          {/* eslint-disable-next-line @next/next/no-img-element */}
          <img
            src={preview}
            alt="–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"
            className="h-48 w-full rounded-lg object-cover"
          />
          <button
            type="button"
            onClick={handleRemove}
            aria-label="–£–¥–∞–ª–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"
            className="absolute top-1 right-1 inline-flex items-center justify-center rounded-full bg-black/60 p-1 text-white backdrop-blur hover:bg-black/80 focus:outline-none focus:ring-2 focus:ring-ring"
          >
            <X size={18} aria-hidden="true" />
          </button>
        </div>
      )}
      {error && <p className="text-sm text-destructive-foreground">{error.message}</p>}
    </div>
  );
}
```

---
### LocationForm

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–∫–∞—Ü–∏–∏.
* **–ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã:** –ü–æ–ª—è —Ñ–æ—Ä–º—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –∫–æ–ª–æ–Ω–∫–∞–º —Ç–∞–±–ª–∏—Ü—ã `locations`: –∑–∞–≥–æ–ª–æ–≤–æ–∫, –æ–ø–∏—Å–∞–Ω–∏–µ, –∞–¥—Ä–µ—Å, —Å—Ç–æ–∏–º–æ—Å—Ç—å, URL, –∞ —Ç–∞–∫–∂–µ –≤—ã–±–æ—Ä —Ç–µ–≥–æ–≤ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ LocationForm:**
```js
'use client';
import React from 'react';
import { useForm } from 'react-hook-form';
import { Input } from '@/components/ui/input';
import { Textarea } from '@/components/ui/textarea';
import { Button } from '@/components/ui/button';
import ChooseTag from '@/components/ChooseTag';
import AttachImage from './AttachImage';
import { useAddLocation } from '@/hooks/useAddLocation';
import { useUpdateLocation } from '@/hooks/useUpdateLocation';
import { useRouter } from 'next/navigation';

/**
 * –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–∫–∞—Ü–∏–∏.
 * –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω initialData.id ‚Äî —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∏–Ω–∞—á–µ ‚Äî —Å–æ–∑–¥–∞–Ω–∏—è.
 */
export default function LocationForm({ initialData = {}, onSuccess }) {
  const router = useRouter();
  const addLocation = useAddLocation();
  const updateLocation = useUpdateLocation();
  const isEditMode = Boolean(initialData.id);

  const {
    control,
    register,
    handleSubmit,
    formState: { errors },
  } = useForm({
    defaultValues: {
      title:       initialData.title       || '',
      description: initialData.description || '',
      address:     initialData.address     || '',
      cost:        initialData.cost        || '',
      sourceUrl:   initialData.sourceUrl   || '',
      tags:        initialData.tags        || [],
      imageFile:   null,
    },
  });

  const onSubmit = (data) => {
    // –°–æ–±–∏—Ä–∞–µ–º payload —Å file –∏ —Å—Ç–∞—Ä—ã–º imgUrl
    const payload = {
      title:       data.title,
      description: data.description,
      address:     data.address,
      cost:        data.cost,
      sourceUrl:   data.sourceUrl,
      imageFile:   data.imageFile,
      imgUrl:      initialData.imgUrl   || null,
      tags:        data.tags,
    };

    if (isEditMode) {
      updateLocation.mutate(
        { id: initialData.id, data: payload },
        { onSuccess: () => onSuccess?.() }
      );
    } else {
      addLocation.mutate(
        payload,
        { onSuccess: (loc) => router.push(`/locations/${loc.id}`) }
      );
    }
  };

  const isSubmitting = isEditMode
    ? updateLocation.isLoading
    : addLocation.isLoading;

  return (
    <form onSubmit={handleSubmit(onSubmit)} className="space-y-6">
      {/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */}
      <div>
        <label htmlFor="title" className="block text-sm font-medium">
          –ó–∞–≥–æ–ª–æ–≤–æ–∫
        </label>
        <Input
          id="title"
          {...register('title', { required: '–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ' })}
          className="mt-1 w-full"
        />
        {errors.title && (
          <p className="mt-1 text-sm text-red-600">
            {errors.title.message}
          </p>
        )}
      </div>

      {/* –û–ø–∏—Å–∞–Ω–∏–µ */}
      <div>
        <label htmlFor="description" className="block text-sm font-medium">
          –û–ø–∏—Å–∞–Ω–∏–µ
        </label>
        <Textarea
          id="description"
          {...register('description')}
          className="mt-1 w-full"
          rows={4}
        />
      </div>

      {/* –ê–¥—Ä–µ—Å */}
      <div>
        <label htmlFor="address" className="block text-sm font-medium">
          –ê–¥—Ä–µ—Å
        </label>
        <Input
          id="address"
          {...register('address')}
          className="mt-1 w-full"
        />
      </div>

      {/* –°—Ç–æ–∏–º–æ—Å—Ç—å */}
      <div>
        <label htmlFor="cost" className="block text-sm font-medium">
          –°—Ç–æ–∏–º–æ—Å—Ç—å
        </label>
        <Input
          id="cost"
          type="number"
          {...register('cost')}
          className="mt-1 w-full"
        />
      </div>

      {/* –°—Å—ã–ª–∫–∞ –Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫ */}
      <div>
        <label htmlFor="sourceUrl" className="block text-sm font-medium">
          –°—Å—ã–ª–∫–∞ –Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫
        </label>
        <Input
          id="sourceUrl"
          {...register('sourceUrl')}
          className="mt-1 w-full"
        />
      </div>

      {/* –í—ã–±–æ—Ä —Ç–µ–≥–æ–≤ */}
      <div>
        <label className="block text-sm font-medium">–¢–µ–≥–∏</label>
        <ChooseTag control={control} name="tags" />
      </div>

      {/* –ö–∞—Ä—Ç–∏–Ω–∫–∞ */}
      <div>
        <label className="block text-sm font-medium">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</label>
        <AttachImage control={control} name="imageFile" initialUrl={initialData.imgUrl} className="mt-1" />
      </div>

      {/* –ö–Ω–æ–ø–∫–∞ */}
      <Button type="submit" disabled={isSubmitting}>
        {isEditMode
          ? isSubmitting
            ? '–°–æ—Ö—Ä–∞–Ω—è–µ–º‚Ä¶'
            : '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è'
          : isSubmitting
          ? '–°–æ—Ö—Ä–∞–Ω—è–µ–º‚Ä¶'
          : '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å'}
      </Button>
    </form>
  );
}
```
---
### SkeletonCard

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞–≥–ª—É—à–∫–∞-–∫–∞—Ä—Ç–æ—á–∫–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö (placeholder skeleton).
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–µ—Ä—ã–π –±–ª–æ–∫ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π –ø—É–ª—å—Å–∞—Ü–∏–∏ (–∏—Å–ø–æ–ª—å–∑—É—è –∫–ª–∞—Å—Å—ã Tailwind `animate-pulse` –∏–ª–∏ Framer Motion) –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ç–æ–º –∂–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ `LocationList` –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ SkeletonCard:**
```js
"use client";
import React from "react";

const SkeletonCard = () => (
  <div className="animate-pulse rounded-2xl bg-gray-200 p-4 shadow">
    <div className="h-40 w-full rounded-lg bg-gray-300"></div>
    <div className="mt-4 h-6 w-3/4 rounded bg-gray-300"></div>
    <div className="mt-2 h-4 w-1/2 rounded bg-gray-300"></div>
    <div className="mt-4 flex space-x-2">
      <div className="h-6 w-16 rounded bg-gray-300"></div>
      <div className="h-6 w-16 rounded bg-gray-300"></div>
    </div>
  </div>
);
export default SkeletonCard;
```

---
### Providers.js

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ï–¥–∏–Ω–æ–∂–¥—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç `QueryClient`, –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ React¬†Query, Auth –∏ Theme –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã; –ø–æ–¥–∫–ª—é—á–∞–µ—Ç Devtools –≤¬†dev‚Äë—Å—Ä–µ–¥–µ.&#x20;
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:**
  * –°–æ–∑–¥–∞—ë—Ç `queryClient` —á–µ—Ä–µ–∑ `createQueryClient()` (—Å–º. `lib/reactQuery.js`).
  * –í–∫–ª—é—á–∞–µ—Ç `<ReactQueryDevtools />` —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `NODE_ENV !== 'production'`.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ Providers.js:**
```js
'use client';
import { useState } from 'react';
import { QueryClientProvider } from '@tanstack/react-query';
import { ReactQueryDevtools } from '@tanstack/react-query-devtools';

import { createQueryClient } from '@/lib/reactQuery';
import AuthProvider from '@/components/AuthProvider';
import ThemeProvider from '@/components/ThemeProvider';

export default function Providers({ children }) {
  const [queryClient] = useState(() => createQueryClient());

  return (
    <QueryClientProvider client={queryClient}>
      <AuthProvider>
        <ThemeProvider>{children}</ThemeProvider>
      </AuthProvider>

      {process.env.NODE_ENV !== 'production' && <ReactQueryDevtools />}
    </QueryClientProvider>
  );
}
```

---
### ThemeProvider.js

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–µ–ª–µ–≥–∏—Ä—É–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–æ–π –ø–∞–∫–µ—Ç—É `next-themes`; –¥–æ–±–∞–≤–ª—è–µ—Ç/—É–¥–∞–ª—è–µ—Ç –∫–ª–∞—Å—Å `dark` –Ω–∞ –∫–æ—Ä–Ω–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞.&#x20;
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ `Providers.js`; —á–∏—Ç–∞–µ—Ç/–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ç–µ–º—É –≤ `localStorage` (–º–µ—Ö–∞–Ω–∏–∑–º `next-themes`).
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ Providers.js:**
```js
'use client';
import { ThemeProvider as NextThemesProvider } from 'next-themes';

export default function ThemeProvider({ children }) {
  return (
    <NextThemesProvider attribute="class" defaultTheme="black">
      {children}
    </NextThemesProvider>
  );
}
```

---
## –ê–∫—Ç—É–∞–ª—å–Ω—ã–π –∫–æ–¥ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ —Ö—É–∫–æ–≤ / —É—Ç–∏–ª–∏—Ç

### –•—É–∫ useAuth.js

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–∞—Å—Ç–æ–º–Ω—ã–π —Ö—É–∫ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
* **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç NextAuth.js (`useSession`) –∏–ª–∏ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç HTTP-only cookie `next-auth.session-token`. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç `user` (–æ–±—ä–µ–∫—Ç —Å `id`), —Ñ–ª–∞–≥ `isLoading` –∏ –º–µ—Ç–æ–¥—ã `signIn(username)` –∏ `signOut()`. –ü—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ `useAuth` –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–µ—Å—Å–∏—é –∏–∑ cookie –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –µ–µ —Å –≥–ª–æ–±–∞–ª—å–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, React Context –∏–ª–∏ Zustand).
* **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ `Layout` –¥–ª—è –∑–∞—â–∏—Ç—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤; –≤ `LoginModal` –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Ö–æ–¥–∞; –≤ `Header` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –∫–∞–∫—É—é –∫–Ω–æ–ø–∫—É –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å. –í —Å–≤—è–∑–∏ —Å —ç—Ç–∏–º –≤ `Layout` –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è `router.push('/login')`, –µ—Å–ª–∏ —Å–µ—Å—Å–∏—è –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ useAuth.js:**
```js
'use client';
import { useSession, signIn, signOut } from 'next-auth/react';

export function useAuth() {
  const { data: session, status } = useSession();
  return {
    user: session?.user ?? null,
    isLoading: status === 'loading',
    signIn,
    signOut,
  };
}
```
---
### useAddLocation

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú—É—Ç–∞—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –ª–æ–∫–∞—Ü–∏–∏.
* **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:** 
  * `useMutation(addLocationFn, { onSuccess }).`
  * `addLocationFn` –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ Supabase Storage (–µ—Å–ª–∏ —Ñ–∞–π–ª –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç), –ø–æ–ª—É—á–∞–µ—Ç `publicUrl`, –∑–∞—Ç–µ–º `POST /rest/v1/locations` c‚ÄØ—Ç–µ–ª–æ–º¬†`{ ‚Ä¶payload, image_url: publicUrl }`.
  * –í `onSuccess` –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è `['locations']` –∏ `['tags']`.
* **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** `LocationForm` –≤¬†`AddLocationPage`
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ useAddLocation:**
```js
'use client';
import { useMutation, useQueryClient } from '@tanstack/react-query';
import { useSession } from 'next-auth/react';
import { supabase } from '@/lib/supabaseClient';
import toast from 'react-hot-toast';
import uploadImage from '@/lib/uploadImage';

/**
 * –ú—É—Ç–∞—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –ª–æ–∫–∞—Ü–∏–∏ —Å –∑–∞–≥—Ä—É–∑–∫–æ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ Storage.
 */
export function useAddLocation() {
  const queryClient = useQueryClient();
  const { data: session } = useSession();
  const userId = session?.user?.id;

  return useMutation({
    mutationFn: async (formData) => {
      if (!userId) {
        throw new Error('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω');
      }
      const { imageFile, tags, ...rest } = formData;

      // 1. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–≥–æ–≤
      let tagList = [];
      if (Array.isArray(tags)) {
        tagList = tags;
      } else if (typeof tags === 'string' && tags.trim()) {
        tagList = tags.split(',').map(t => t.trim()).filter(Boolean);
      }

      // 2. –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
      let image_url = null;
      if (imageFile) {
        try {
          image_url = await uploadImage(imageFile, userId);
        } catch (err) {
          toast.error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ');
          throw err;
        }
      }

      // 3. –í—ã–∑–æ–≤ RPC –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ª–æ–∫–∞—Ü–∏–∏ –≤–º–µ—Å—Ç–µ —Å —Ç–µ–≥–∞–º–∏
      const { data, error } = await supabase.rpc(
        'create_location_with_tags',
        {
          p_user_id:     userId,
          p_title:       rest.title,
          p_description: rest.description,
          p_address:     rest.address,
          p_cost:        rest.cost,
          p_source_url:  rest.sourceUrl,
          p_image_url:   image_url,
          p_tags:        tagList,
        }
      );
      if (error) throw error;
      return data;
    },
    onSuccess: () => {
      queryClient.invalidateQueries(['locations']);
      queryClient.invalidateQueries(['tags']);
      toast.success('–õ–æ–∫–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞');
    },
    onError: (err) => {
      toast.error(err.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ª–æ–∫–∞—Ü–∏–∏');
    },
  });
}
```

---
### useLocations.js

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–∞—Å—Ç–æ–º–Ω—ã–π —Ö—É–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–æ–º –ª–æ–∫–∞—Ü–∏–π.
* **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:** –û–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç React Query (`useInfiniteQuery` –∏–ª–∏ `useQuery`) –¥–ª—è –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ Supabase API (REST) –∏–ª–∏ —á–µ—Ä–µ–∑ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π SDK. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ (limit, offset –∏–ª–∏ –∫—É—Ä—Å–æ—Ä) –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–ø–æ `searchQuery` –∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Ç–µ–≥–∞–º –∏–∑ Zustand). –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `data` (–º–∞—Å—Å–∏–≤ –ª–æ–∫–∞—Ü–∏–π), `isLoading`, `isError`, `fetchNextPage`, `hasNextPage` –∏ —Ç. –¥. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –º—É—Ç–∞—Ü–∏—è—Ö (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ) —á–µ—Ä–µ–∑ React Query.
* **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ (`LocationListPage`) –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø–∏—Å–∫–∞; –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ `useQuery(['location', id], ...)`). –¢–∞–∫–∂–µ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è —Ç–µ–≥–æ–≤ (`RPC` –∏–ª–∏ –ø–∞—Ç—á–∏ —á–µ—Ä–µ–∑ Supabase) –∫–∞–∫ –º–µ—Ç–æ–¥—ã `mutate`.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ useLocations.js:** 
```js
'use client';
import { useInfiniteQuery } from '@tanstack/react-query';
import { supabase } from '@/lib/supabaseClient';
import { useUIStore } from '@/store/uiStore';

const PAGE_SIZE = 9;

export function useLocations() {
  const searchQuery = useUIStore((s) => s.searchQuery);
  const selectedTags = useUIStore((s) => s.selectedTags);

  const fetchLocations = async ({ pageParam = null }) => {
    let query = supabase
      .from('locations')
      .select('*, locations_tags(tag_id, tags(name))')
      .order('created_at', { ascending: false })
      .limit(PAGE_SIZE);
    // –ö—É—Ä—Å–æ—Ä: –±–µ—Ä—ë–º –∑–∞–ø–∏—Å–∏ ¬´—Å—Ç–∞—Ä—à–µ¬ª (–º–µ–Ω—å—à–µ created_at)
    if (pageParam) {
      query = query.lt('created_at', pageParam);
    }
    // –ü–æ–∏—Å–∫ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É (ilike, –Ω–µ—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É)
    if (searchQuery) {
      query = query.ilike('title', `%${searchQuery}%`);
    }
    // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Ç–µ–≥–∞–º (JOIN locations_tags)
   if (selectedTags.length) {
      const {data: tagRows, error: tagError } = await supabase
        .from('tags')
        .select('id,name')
        .in('name', selectedTags);
      if (tagError) throw tagError;
      const tagIds = tagRows.map((t) => t.id);
      query = query.in('locations_tags.tag_id', tagIds);
    }

    const { data, error } = await query;
    console.log('got', data.length, 'items; last created_at =', data[data.length-1]?.created_at);
    if (error) throw error;

    const items = data.map(({ locations_tags, ...loc }) => ({
    ...loc,
    imgUrl: loc.image_url,
    tags: locations_tags.map((lt) => lt.tags.name),
    }));

    return {
      items,
      nextCursor:
        data.length === PAGE_SIZE ? data[data.length - 1].created_at : undefined,
    };
  };

  return useInfiniteQuery({
    queryKey: ['locations', { search: searchQuery, tags: selectedTags }],
    queryFn: fetchLocations,
    getNextPageParam: (lastPage) => lastPage.nextCursor,
    staleTime: 60_000,
  });
}
```

---
### useUpdateLocation

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú—É—Ç–∞—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ª–æ–∫–∞—Ü–∏–∏.
* **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  * `useMutation(({ id, ...patch }) => PATCH /rest/v1/locations?id=eq.{id}).`
  * –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ç–µ–≥–æ–≤ –≤—ã–∑—ã–≤–∞–µ—Ç RPC‚ÄØ`update_location_with_tags`.
  * –ò–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç¬†`['location', id]`‚ÄØ–∏‚ÄØ`['locations']`. 
* **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ö–Ω–æ–ø–∫–∞‚ÄØ`–°–æ—Ö—Ä–∞–Ω–∏—Ç—å` –≤ `LocationForm` (—Ä–µ–∂–∏–º‚ÄØEdit) –∏ `EditButton` –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ useUpdateLocation:**
```js
'use client';
import { useMutation, useQueryClient } from '@tanstack/react-query';
import { useSession } from 'next-auth/react';
import { supabase } from '@/lib/supabaseClient';
import toast from 'react-hot-toast';
import uploadImage from '@/lib/uploadImage';
import deleteImage from '@/lib/deleteImage';
/**
 * –ú—É—Ç–∞—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ª–æ–∫–∞—Ü–∏–∏ —Å –≤–æ–∑–º–æ–∂–Ω–æ–π –∑–∞–º–µ–Ω–æ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
 * –ï—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–º–µ–Ω–µ–Ω–æ, –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏
 * —Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª –≤¬†Storage –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç—Å—è.
 */
export function useUpdateLocation() {
  const queryClient = useQueryClient();
  const { data: session } = useSession();
  const userId = session?.user?.id;

  return useMutation({
    mutationFn: async ({ id, data }) => {
      if (!userId) {
        throw new Error('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω');
      }

      const { imageFile, imgUrl: oldImageUrl, tags, ...rest } = data;
      /* 1. –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Å–ø–∏—Å–æ–∫ —Ç–µ–≥–æ–≤ */
      const tagList = Array.isArray(tags)
        ? tags
        : typeof tags === 'string' && tags.trim()
        ? tags.split(',').map((t) => t.trim()).filter(Boolean)
        : [];
      /* 2. –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω¬†File) */
      let publicUrl = oldImageUrl;
      const isImageReplaced = Boolean(imageFile);
      if (isImageReplaced) {
        try {
          publicUrl = await uploadImage(imageFile, userId);
        } catch (err) {
          toast.error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ');
          throw err;
        }
      }
      /* 3. RPC‚Äë–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞—Ü–∏–∏ –∏ —Ç–µ–≥–æ–≤ */
      const { data: updated, error } = await supabase.rpc(
        'update_location_with_tags',
        {
          p_loc_id:      id,
          p_title:       rest.title,
          p_description: rest.description,
          p_address:     rest.address,
          p_cost:        rest.cost,
          p_source_url:  rest.sourceUrl,
          p_image_url:   publicUrl,
          p_tags:        tagList,
        }
      );
      if (error) throw error;
      /* 4. –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∞–ø–¥–µ–π—Ç–∞ */
      if (isImageReplaced && oldImageUrl && oldImageUrl !== publicUrl) {
        // –ù–µ –±–ª–æ–∫–∏—Ä—É–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Ü–µ–ø–æ—á–∫—É ‚Äî –æ—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞
        deleteImage(oldImageUrl);
      }

      return updated;
    },

    onSuccess: (_data, { id }) => {
      queryClient.invalidateQueries(['location', id]);
      queryClient.invalidateQueries(['locations']);
      toast.success('–õ–æ–∫–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∞');
    },

    onError: (err) => {
      toast.error(err.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ª–æ–∫–∞—Ü–∏–∏');
    },
  });
}
```

---
### useDeleteLocation

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –ª–æ–∫–∞—Ü–∏—é –∏–∑ –±–∞–∑—ã —á–µ—Ä–µ–∑ RPC‚Äë—Ñ—É–Ω–∫—Ü–∏—é `delete_location`. –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–≤—è–∑–∏ –ª–æ–∫–∞—Ü–∏–∏ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö `favourites` –∏ `locations_tags`. –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ (–µ—Å–ª–∏ –±—ã–ª). –û–±–Ω–æ–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫—ç—à React‚ÄëQuery –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ UI
* **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
1. **RPC‚Äë—É–¥–∞–ª–µ–Ω–∏–µ –ª–æ–∫–∞—Ü–∏–∏**
   –í—ã–∑—ã–≤–∞–µ—Ç –Ω–∞ Supabase —Ñ—É–Ω–∫—Ü–∏—é `delete_location`, –∫–æ—Ç–æ—Ä–∞—è –∫–∞—Å–∫–∞–¥–Ω–æ —É–¥–∞–ª—è–µ—Ç –∑–∞–ø–∏—Å—å –∏–∑ `locations` –∏ –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏ –∑–∞–ø–∏—Å–∏ –≤ `locations_tags`.
2. **–£–¥–∞–ª–µ–Ω–∏–µ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ**
   –£–¥–∞–ª—è–µ—Ç –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `favourites` –≤—Å–µ –∑–∞–ø–∏—Å–∏, –≥–¥–µ `location_id` —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —É–¥–∞–ª—è–µ–º–æ–π –ª–æ–∫–∞—Ü–∏–µ–π. –û—à–∏–±–∫–∏ –ø—Ä–∏ —ç—Ç–æ–º —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è, –Ω–æ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞—é—Ç –ø—Ä–æ—Ü–µ—Å—Å.
3. **–£–¥–∞–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**
   –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω URL –∫–∞—Ä—Ç–∏–Ω–∫–∏, –≤—ã–∑—ã–≤–∞–µ—Ç —É—Ç–∏–ª–∏—Ç—É `deleteImage` –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –∏–∑ Storage. –û—à–∏–±–∫–∏ —Ç–∞–∫–∂–µ —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è.
4. **–ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–µ–π**
   * –ò–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç React‚ÄëQuery-–∑–∞–ø—Ä–æ—Å—ã `["locations"]` –∏ `["favourites"]`, —á—Ç–æ–±—ã —Å–ø–∏—Å–æ–∫ –ª–æ–∫–∞—Ü–∏–π –∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –æ–±–Ω–æ–≤–∏–ª—Å—è.
   * –° –ø–æ–º–æ—â—å—é zustand‚Äë—Å—Ç–æ—Ä–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ñ–ª–∞–≥ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–ª—è —ç—Ç–æ–π –ª–æ–∫–∞—Ü–∏–∏ –≤ UI.
5. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
   –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ RPC –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —à–∞–≥–æ–≤ –±—Ä–æ—Å–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç toast‚Äë—Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–µ–∫—Å—Ç–æ–º –æ—à–∏–±–∫–∏.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ useDeleteLocation.js:**
```js
"use client";
import { useMutation, useQueryClient } from "@tanstack/react-query";
import { supabase } from "@/lib/supabaseClient";
import deleteImage from "@/lib/deleteImage";
import toast from "react-hot-toast";
import { useUIStore } from "@/store/uiStore";
/**
 * useDeleteLocation ‚Äî —É–¥–∞–ª—è–µ—Ç –ª–æ–∫–∞—Ü–∏—é —á–µ—Ä–µ–∑ RPC‚Äë—Ñ—É–Ω–∫—Ü–∏—é `delete_location`,
 * —á–∏—Å—Ç–∏—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∏–∑ favourites, locations_tags –∏ —Ñ–∞–π–ª –≤ Storage.
 * –ü–æ—Å–ª–µ —É—Å–ø–µ—Ö–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω `router.push('/')` –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞,
 * –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —ç—Ç–æ—Ç —Ö—É–∫ (—Å–º.‚ÄØLocationDetailPage).
 *
 * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç `mutation` –∏–∑ React‚ÄëQuery.
 */
export function useDeleteLocation() {
  const queryClient = useQueryClient();
  const clearFavourite = useUIStore((s) => s.toggleFavourite);

  return useMutation({
    /**
     * @param {{ id: string, imageUrl?: string|null }} payload
     */
    mutationFn: async ({ id, imageUrl }) => {
      // 1) –£–¥–∞–ª—è–µ–º –∑–∞–ø–∏—Å—å + —Å–≤—è–∑–∫–∏ —Ç–µ–≥–æ–≤ –∫–∞—Å–∫–∞–¥–æ–º —á–µ—Ä–µ–∑ RPC
      const { error: rpcError } = await supabase.rpc("delete_location", {
        location_id: id,
      });
      if (rpcError) throw rpcError;
      // 2) –£–¥–∞–ª—è–µ–º favourites —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ —ç—Ç–æ–π –ª–æ–∫–∞—Ü–∏–∏ (–±–µ–∑ RPC)
      const { error: favErr } = await supabase
        .from("favourites")
        .delete()
        .eq("location_id", id);
      if (favErr) {
        // –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ ‚Äî –ø—Ä–æ—Å—Ç–æ –ª–æ–≥–∏—Ä—É–µ–º
        console.warn("Failed to delete favourites for location", favErr);
      }
      // 3) –£–¥–∞–ª—è–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É –∏–∑ Storage, –µ—Å–ª–∏ –±—ã–ª–∞
      try {
        if (imageUrl) await deleteImage(imageUrl);
      } catch (imgErr) {
        console.warn("Failed to delete image file:", imgErr);
      }

      return { id };
    },
    // ====== React‚ÄëQuery callbacks ======
    onSuccess: (_data, { id }) => {
      /* –ò–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ–º –∫–µ—à–∏ —Å–ø–∏—Å–∫–∞ –ª–æ–∫–∞—Ü–∏–π / –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ */
      queryClient.invalidateQueries(["locations"]);
      queryClient.invalidateQueries({ queryKey: ["favourites"] });
      // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –±—ã–ª
      clearFavourite(id);
      toast.success("–õ–æ–∫–∞—Ü–∏—è —É–¥–∞–ª–µ–Ω–∞");
    },

    onError: (err) => {
      toast.error(err?.message || "–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –ª–æ–∫–∞—Ü–∏—é");
    },
  });
}
```

---
### useOneLocation.js

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–∞—Å—Ç–æ–º–Ω—ã–π —Ö—É–∫ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –æ–¥–Ω–æ–π –ª–æ–∫–∞—Ü–∏–∏ –ø–æ‚ÄØ`id` –≤–º–µ—Å—Ç–µ —Å –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–º–∏ —Ç–µ–≥–∞–º–∏ –∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–º‚ÄØ¬´–∏–∑–±—Ä–∞–Ω–Ω–æ–µ¬ª –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
* **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:** 
  * –û–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç `useQuery(['location', id], fetcher`, `{ staleTime:‚ÄØ60_000 }).`
  * fetcher –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ Supabase‚ÄØREST:
  `GET /rest/v1/locations?id=eq.{id}&select=*,tags(*),favourites(user_id)&limit=1.`
  * –í —Ä–µ—Å–ø–æ–Ω—Å–µ –≤—ã—á–∏—Å–ª—è–µ—Ç `isFavourite = favourites.length‚ÄØ>‚ÄØ0.`
  * –ü—Ä–∏ –æ—à–∏–±–∫–µ ‚Äî –≤—ã–≤–æ–¥–∏—Ç `toast` —á–µ—Ä–µ–∑ `react-hot-toast`.
* **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ `LocationDetailPage`, `LocationForm`‚ÄØ(—Ä–µ–∂–∏–º‚ÄØEdit) –∏ –≤ –º–æ–¥–∞–ª–∫–µ –±—ã—Å—Ç—Ä–æ–≥–æ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ useOneLocation.js:**
```js
'use client';
import { useQuery } from '@tanstack/react-query';
import { supabase } from '@/lib/supabaseClient';
import toast from 'react-hot-toast';

/**
 * useOneLocation ‚Äî –≥—Ä—É–∑–∏—Ç –¥–µ—Ç–∞–ª—å –ª–æ–∫–∞—Ü–∏–∏ + —Ç–µ–≥–∏ (+ –ø—Ä–∏–∑–Ω–∞–∫ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ).
 * @param id UUID –ª–æ–∫–∞—Ü–∏–∏
 */
export function useOneLocation(id) {
  return useQuery({
    queryKey: ['location', id],
    enabled: !!id,
    staleTime: 60_000,
    queryFn: async () => {
      /* 1. REST‚Äëjoin locations¬†‚Üê¬†locations_tags¬†‚Üê¬†tags */
      const { data, error } = await supabase
        .from('locations')
        .select(
          '*, locations_tags(tag_id, tags(name)), favourites!left(user_id)'
        )                      // favourites –Ω—É–∂–µ–Ω, —á—Ç–æ–±—ã –≤—ã—á–∏—Å–ª–∏—Ç—å isFavourite
        .eq('id', id)
        .single();

      if (error) throw error;

      return {
        ...data,
        imgUrl: data.image_url,            // camelCase –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ¬†:contentReference[oaicite:2]{index=2}:contentReference[oaicite:3]{index=3}
        tags: data.locations_tags.map((lt) => lt.tags.name),
        isFavourite: data.favourites?.length > 0,
      };
    },
    onError: (err) =>
      toast.error(
        err?.message || '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ª–æ–∫–∞—Ü–∏–∏'
      ),
  });
}
```

---
### –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (Zustand –∏ Context)

* **Zustand Store:** –£–ø—Ä–∞–≤–ª—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–º UI-—Å–æ—Å—Ç–æ—è–Ω–∏–µ–º, –Ω–µ –æ—Ç–Ω–æ—Å—è—â–∏–º—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É. –ù–∞–ø—Ä–∏–º–µ—Ä:

  * `searchQuery` ‚Äî —Ç–µ–∫—É—â–∏–π —Ç–µ–∫—Å—Ç –ø–æ–∏—Å–∫–∞ (–∏–∑ `SearchBar`)
  * `selectedTags: string[]` ‚Äî –º–∞—Å—Å–∏–≤ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ç–µ–≥–æ–≤ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
  * `showLoginModal: boolean` ‚Äî —Ñ–ª–∞–≥ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è `LoginModal`
  * `favorites: string[]` ‚Äî —Å–ø–∏—Å–æ–∫ ID –æ—Ç–º–µ—á–µ–Ω–Ω—ã—Ö –ª–æ–∫–∞—Ü–∏–π (–∏–∑ –∑–∞–¥–∞—á–∏ ¬´–∏–∑–±—Ä–∞–Ω–Ω–æ–µ¬ª; –º–æ–∂–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ localStorage)
  * –ú–µ—Ç–æ–¥—ã `setSearchQuery`, `toggleTag`, `setLoginModal`, `toggleFavorite` –∏ —Ç.–¥.
* **Context API:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –æ–ø—Ü–∏–π, –Ω–∞–ø—Ä–∏–º–µ—Ä `ThemeContext` (—Å–≤–µ—Ç–ª–∞—è/—Ç–µ–º–Ω–∞—è —Ç–µ–º–∞) –∏–ª–∏ `LocaleContext` (—è–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞). –û–±—ã—á–Ω–æ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –≤ `Layout`.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ uiStore.js:**
```js
import { create } from 'zustand';
import { persist } from 'zustand/middleware';

export const useUIStore = create(
  persist(
    (set, get) => ({
      /* ---------- —Å–æ—Å—Ç–æ—è–Ω–∏–µ ---------- */
      searchQuery: '',
      selectedTags: [],
      showLoginModal: false,
      /** –§–ª–∞–≥ ¬´–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ¬ª */
      showOnlyFavourites: false,
      /** Map¬†{id:¬†boolean} –ª–æ–∫–∞–ª—å–Ω–æ –æ—Ç–º–µ—á–µ–Ω–Ω—ã—Ö –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö */
      favourites: {},
      /* ---------- actions ---------- */
      setSearchQuery: (q) => set({ searchQuery: q }),

      toggleTag: (tag) =>
        set((s) => ({
          selectedTags: s.selectedTags.includes(tag)
            ? s.selectedTags.filter((t) => t !== tag)
            : [...s.selectedTags, tag],
        })),

      setLoginModal: (v) => set({ showLoginModal: v }),
      /** –õ–æ–∫–∞–ª—å–Ω—ã–π optimistic‚Äë—Ç–æ–≥–≥–ª –¥–ª—è –æ–¥–Ω–æ–π –ª–æ–∫–∞—Ü–∏–∏ */
      toggleFavourite: (id) =>
        set((s) => ({
          favourites: { ...s.favourites, [id]: !s.favourites[id] },
        })),
      /** –ì–∏–¥—Ä–∞—Ç–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –∏–∑ Supabase */
      hydrateFavourites: (ids) =>
        set(() => ({
          favourites: Object.fromEntries(ids.map((id) => [id, true])),
        })),
      /** –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ ¬´—Ç–æ–ª—å–∫–æ¬†–∏–∑–±—Ä–∞–Ω–Ω–æ–µ¬ª */
      toggleShowOnlyFavourites: () =>
        set((s) => ({ showOnlyFavourites: !s.showOnlyFavourites })),
    }),
    {
      name: 'batumi-ui',
      /** –í localStorage —Ö—Ä–∞–Ω–∏–º —Ç–æ–ª—å–∫–æ actual –∏–∑–±—Ä–∞–Ω–Ω—ã–µ,
          –æ—Å—Ç–∞–ª—å–Ω—ã–µ UI‚Äë—Ñ–ª–∞–≥–∏ –Ω–µ¬†–Ω—É–∂–Ω–æ –ø–µ—Ä—Å–∏—Å—Ç–∏—Ç—å */
      partialize: (s) => ({ favourites: s.favourites }),
    }
  )
);
```

---
### reactQuery.js

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—ë—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π `QueryClient` c¬†–Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∫–µ—à–∞ –∏ —Ä–µ—Ç—Ä–∞–µ–≤, —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–º–∏ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π.&#x20;
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ –≤ `Providers.js`; –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ö—É–∫–∏ (`useLocations`,¬†`useAddLocation`¬†–∏¬†–¥—Ä.) –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ—Ç –∂–µ —ç–∫–∑–µ–º–ø–ª—è—Ä.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ reactQuery.js:**
```js
import { QueryClient } from '@tanstack/react-query';

export function createQueryClient() {
  return new QueryClient({
    defaultOptions: {
      queries: {
        staleTime: 1000 * 60,       // 1 –º–∏–Ω—É—Ç–∞
        gcTime: 1000 * 60 * 30,  // 30 –º–∏–Ω—É—Ç
        refetchOnWindowFocus: false,
        retry: 1,
      },
      mutations: {
        networkMode: 'always',
      },
    },
  });
}
```

---

### supabaseClient.js

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä Supabase JS SDK —Å `anon`‚Äë–∫–ª—é—á–æ–º –∏ URL –∏–∑ env‚Äë–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.&#x20;
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ API‚Äë—Ä–æ—É—Ç–µ `route.js`, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ö—É–∫–∞—Ö (CRUD) –∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ Storage.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ supabaseClient.js:**
```js
import { createClient } from '@supabase/supabase-js';

export const supabase = createClient(
  process.env.NEXT_PUBLIC_SUPABASE_URL,
  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,
  {
    global: { fetch },
  }
);
```

---
### utils.js

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—ä–µ–¥–∏–Ω—è–µ—Ç —É—Å–ª–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã —Å¬†–ø–æ–º–æ—â—å—é `clsx`, –∞ –∑–∞—Ç–µ–º ¬´—Å–∫–ª–µ–∏–≤–∞–µ—Ç¬ª –≤–æ–∑–º–æ–∂–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã —á–µ—Ä–µ–∑ `tailwind-merge`.
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤–æ –≤—Å–µ—Ö React‚Äë–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö, –≥–¥–µ –Ω—É–∂–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å className.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ utils.js:**
```js
import { clsx } from "clsx";
import { twMerge } from "tailwind-merge"

export function cn(...inputs) {
  return twMerge(clsx(inputs));
}
```

---
### uploadImage.js

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `uploadImage` –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –ø—Ä–∏—ë–º–∞ —Ñ–∞–π–ª–æ–≤ (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–ª–∏ –ª—é–±—ã—Ö –¥—Ä—É–≥–∏—Ö —Ç–∏–ø–æ–≤), –∏—Ö –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ Supabase Storage –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç—É –ø—É–±–ª–∏—á–Ω–æ–≥–æ URL –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –û–Ω –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É–µ—Ç –ª–æ–≥–∏–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏, –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∏–º–µ–Ω–∏, —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è ¬´—á–∏—Å—Ç–æ–≥–æ¬ª –ø—É—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ‚ÄØuserId –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω–µ—á–Ω–æ–π —Å—Å—ã–ª–∫–∏, —Å–∫—Ä—ã–≤–∞—è –¥–µ—Ç–∞–ª–∏ —Ä–∞–±–æ—Ç—ã —Å Supabase –æ—Ç –æ—Å—Ç–∞–ª—å–Ω–æ–π —á–∞—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ uploadImage.js:**
```js
import { supabase } from '@/lib/supabaseClient';
/**
 * –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∞–π–ª –≤ Supabase Storage –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–π URL.
 * @param {File} file - —Ñ–∞–π–ª –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
 * @param {string} userId - ID —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –≤ –ø—É—Ç–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è
 * @returns {Promise<string>} –ø—É–±–ª–∏—á–Ω—ã–π URL –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
 */
export default async function uploadImage(file, userId) {
  if (!file) {
    throw new Error('No file provided for upload');
  }
  const bucket = process.env.NEXT_PUBLIC_SUPABASE_BUCKET;
  if (!bucket) {
    throw new Error('Bucket name is not defined in environment variables');
  }
  // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ¬´—á–∏—Å—Ç—ã–π¬ª –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–∞–ø–∫–∏: —Ç–æ–ª—å–∫–æ –ª–∞—Ç–∏–Ω–∏—Ü–∞, —Ü–∏—Ñ—Ä—ã, "-" –∏ "_"
  const safeUserId = (userId || 'anon')
    .toString()
    .replace(/[^A-Za-z0-9_-]/g, '_');
  // –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞
  const ext = file.name.split('.').pop();
  const timestamp = Date.now();
  const randomStr = Math.random().toString(36).substring(2, 8);
  const fileName = `${timestamp}-${randomStr}.${ext}`;
  // –ö–æ–Ω–µ—á–Ω—ã–π –ø—É—Ç—å –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
  const filePath = `${safeUserId}/${fileName}`;
  // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞
  const { error: uploadError } = await supabase.storage
    .from(bucket)
    .upload(filePath, file, { upsert: false });
  if (uploadError) {
    throw uploadError;
  }
  // –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ URL
  const { data: urlData, error: urlError } = supabase.storage
    .from(bucket)
    .getPublicUrl(filePath);
  if (urlError) {
    throw urlError;
  }

  return urlData.publicUrl;
}
```

---
### deleteImage

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±–µ—Å–ø–µ—á–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ä–∞–Ω–µ–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –≤ Supabase Storage —Ñ–∞–π–ª–∞ (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è) –ø–æ –µ–≥–æ –ø—É–±–ª–∏—á–Ω–æ–º—É URL –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å —É—Ç–µ—á–∫–∏ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∏–ª–∏ –Ω–µ–Ω—É–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤, –Ω–µ –Ω–∞—Ä—É—à–∞—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:**
1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ URL**
   * –ï—Å–ª–∏ `imageUrl` –ø—É—Å—Ç–æ–π (`null`, `undefined` –∏–ª–∏ –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞) ‚Äî —Ñ—É–Ω–∫—Ü–∏—è —Å—Ä–∞–∑—É –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `void`.
2. **–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –±–∞–∫–µ—Ç–∞**
   * –ß–∏—Ç–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `NEXT_PUBLIC_SUPABASE_BUCKET`.
   * –ï—Å–ª–∏ –æ–Ω–∞ –Ω–µ –∑–∞–¥–∞–Ω–∞ ‚Äî –≤—ã–≤–æ–¥–∏—Ç –æ—à–∏–±–∫—É –≤ `console.error` –∏ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É.
3. **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—É—Ç–∏ —Ñ–∞–π–ª–∞**
   * –ò—â–µ—Ç –≤ `imageUrl` –º–∞—Ä–∫–µ—Ä `/${bucket}/`.
   * –ï—Å–ª–∏ –º–∞—Ä–∫–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî –≤—ã–≤–æ–¥–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ `console.warn` –∏ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É.
   * –ò–∑–≤–ª–µ–∫–∞–µ—Ç —á–∞—Å—Ç—å —Å—Ç—Ä–æ–∫–∏ –ø–æ—Å–ª–µ –º–∞—Ä–∫–µ—Ä–∞ ‚Äî —ç—Ç–æ –ø—É—Ç—å –≤–Ω—É—Ç—Ä–∏ –±–∞–∫–µ—Ç–∞.
4. **–£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞**
   * –í—ã–∑—ã–≤–∞–µ—Ç `supabase.storage.from(bucket).remove([filePath])`.
   * –ï—Å–ª–∏ Supabase –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É ‚Äî –≤—ã–≤–æ–¥–∏—Ç –µ—ë –≤ `console.error`, –Ω–æ –Ω–µ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ uploadImage.js:**
```js
import { supabase } from '@/lib/supabaseClient';
/**
 * –£–¥–∞–ª—è–µ—Ç —Ñ–∞–π–ª –∏–∑ Supabase¬†Storage –ø–æ –µ–≥–æ –ø—É–±–ª–∏—á–Ω–æ–º—É URL.
 * –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫, –Ω–æ –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤¬†console.
 *
 * @param {string|null|undefined} imageUrl ‚Äì –ø—É–±–ª–∏—á–Ω—ã–π URL —Å—Ç–∞—Ä–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
 * @returns {Promise<void>}
 */
export default async function deleteImage(imageUrl) {
  if (!imageUrl) return;

  const bucket = process.env.NEXT_PUBLIC_SUPABASE_BUCKET;
  if (!bucket) {
    console.error('ENV‚ÄØNEXT_PUBLIC_SUPABASE_BUCKET¬†not defined ‚Äì skip delete.');
    return;
  }
  // –ò—â–µ–º —á–∞—Å—Ç—å –ø—É—Ç–∏ –ø–æ—Å–ª–µ¬†‚Ä¶/object/public/{bucket}/
  const marker = `/${bucket}/`;
  const idx = imageUrl.indexOf(marker);
  if (idx === -1) {
    console.warn('deleteImage: cannot parse path from url', imageUrl);
    return;
  }
  const filePath = imageUrl.slice(idx + marker.length);

  const { error } = await supabase.storage.from(bucket).remove([filePath]);
  if (error) {
    console.error('deleteImage: failed to remove old image', error);
  }
}
```

---
### useTags

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—É–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Ç–µ–≥–æ–≤.
* **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  * `useQuery(['tags'], () => GET /rest/v1/tags?select=*)`, `{ staleTime:‚ÄØ5*60_000 }`.
  * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ —Ç–µ–≥–æ–≤, –¥–æ—Å—Ç—É–ø–Ω—ã–π –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è –≤‚ÄØ—Ñ–æ—Ä–º–∞—Ö.
* **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** `SearchBar` (—Ñ–∏–ª—å—Ç—Ä), `LocationForm` (multi‚Äëselect —Ç–µ–≥–∏), –∞ —Ç–∞–∫–∂–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ useTags.js:**
```js
"use client";
import { useQuery } from "@tanstack/react-query";
import { supabase } from "@/lib/supabaseClient";

/** –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç [{ id, name }] –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `tags` —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º 5‚ÄØ–º–∏–Ω—É—Ç. */
export function useTags() {
  return useQuery({
    queryKey: ["tags"],
    queryFn: async () => {
      const { data, error } = await supabase
        .from("tags")
        .select("*")
        .order("name");
      if (error) throw error;
      return data;
    },
    staleTime: 5 * 60_000, // 5‚ÄØ–º–∏–Ω—É—Ç
  });
}
```

---
* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—É–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Ç–µ–≥–æ–≤.
* **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:** TagsPrefetcher ‚Äî ¬´–Ω–∏—á–µ–≥–æ –Ω–µ —Ä–µ–Ω–¥–µ—Ä–∏—Ç¬ª, –Ω–æ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –≤—ã–∑—ã–≤–∞–µ—Ç useTags() –∏ —Ç–µ–º —Å–∞–º—ã–º –ø—Ä–æ–≥—Ä–µ–≤–∞–µ—Ç –∫–µ—à ['tags'].
* **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** `SearchBar` (—Ñ–∏–ª—å—Ç—Ä)
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ TagsPrefetcher.js:**
```js
"use client";
import { useTags } from "@/hooks/useTags";
export default function TagsPrefetcher() {
  useTags();
  return null;
}
```

---
### useToggleFavourite

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú—É—Ç–∞—Ü–∏—è‚Äë–ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å ¬´–¥–æ–±–∞–≤–∏—Ç—å‚ÄØ/‚ÄØ—É–¥–∞–ª–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ¬ª –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
* **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  * –ï—Å–ª–∏ –ª–æ–∫–∞—Ü–∏—è –Ω–µ –ª—é–±–∏–º–∞ ‚Üí `POST /rest/v1/favourites { user_id, location_id }`.
  * –ò–Ω–∞—á–µ ‚Üí `DELETE /rest/v1/favourites?user_id=eq.{uid}&location_id=eq.{id}`.
  * –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç `favorites` –≤ Zustand (`toggleFavorite(id)`) –∏ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç `['favourites', userId]`, `['location', id]`, `['locations']`.
* **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ LocationCard –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∏–∫–æ–Ω–∫—É –∏–∑–±—Ä–∞–Ω–Ω–æ–µ‚≠ê
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ useToggleFavourite.js:**
```js
'use client';
import { useCallback } from 'react';
import { useMutation, useQueryClient } from '@tanstack/react-query';
import { supabase } from '@/lib/supabaseClient';
import toast from 'react-hot-toast';
import { useAuth } from '@/hooks/useAuth';
import { useUIStore } from '@/store/uiStore';
/**
 * useToggleFavourite(id)¬†‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é‚Äë–æ–±—Ä–∞–±–æ—Ç—á–∏–∫, –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å
 * –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ ¬´–∑–≤—ë–∑–¥–æ—á–∫—É¬ª. –•—É–∫:
 *  ‚Ä¢¬†–û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–ª–∞–≥ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –≤¬†Zustand;
 *  ‚Ä¢¬†POST‚Ää/DELETE¬†–≤¬†—Ç–∞–±–ª–∏—Ü—É¬†favourites;
 *  ‚Ä¢¬†–ò–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∫–µ—à–∏ favourites, location, locations;
 *  ‚Ä¢¬†–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ¬†–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω¬†‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç LoginModal.
 * @param {string} locationId¬†UUID –ª–æ–∫–∞—Ü–∏–∏
 * @returns {() => void}¬†—Ñ—É–Ω–∫—Ü–∏—è‚Äë–æ–±—Ä–∞–±–æ—Ç—á–∏–∫
 */
export function useToggleFavourite(locationId) {
  const { user } = useAuth();
  const userId = user?.id ?? null;

  const queryClient = useQueryClient();
  const setLoginModal = useUIStore((s) => s.setLoginModal);
  const favouritesMap  = useUIStore((s) => s.favourites);
  const toggleFavouriteLocal = useUIStore((s) => s.toggleFavourite);
  /** –†–µ–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∫¬†Supabase */
  const mutation = useMutation({
    mutationFn: async (isCurrentlyFav) => {
      if (!userId) throw new Error('auth-required');

      if (isCurrentlyFav) {
        // —É–¥–∞–ª–∏—Ç—å
        const { error } = await supabase
          .from('favourites')
          .delete()
          .eq('user_id', userId)
          .eq('location_id', locationId);
        if (error) throw error;
      } else {
        // –¥–æ–±–∞–≤–∏—Ç—å
        const { error } = await supabase
          .from('favourites')
          .insert({ user_id: userId, location_id: locationId });
        if (error) throw error;
      }
    },
    // ---------- optimistic update ----------
    onMutate: async () => {
      const prevIsFav = Boolean(favouritesMap[locationId]);
      toggleFavouriteLocal(locationId);                 // –ª–æ–∫–∞–ª—å–Ω—ã–π optimistic
      await queryClient.cancelQueries(['favourites', userId]);
      return { prevIsFav };
    },

    onError: (err, _vars, ctx) => {
      if (err?.message === 'auth-required') {
        setLoginModal(true);                            // –æ—Ç–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª–∫—É –ª–æ–≥–∏–Ω–∞
        return;
      }
      // –æ—Ç–∫–∞—Ç optimistic‚Äë–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
      toggleFavouriteLocal(locationId);
      if (ctx?.prevIsFav !== undefined) {
        queryClient.setQueryData(['favourites', userId], (old) => old);
      }
      toast.error(err.message || '–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å –∏–∑–±—Ä–∞–Ω–Ω–æ–µ');
    },

    onSuccess: () => {
      queryClient.invalidateQueries(['favourites', userId]);
      queryClient.invalidateQueries(['location', locationId]);
      queryClient.invalidateQueries(['locations']);
    },
  });
  /** –•—ç–Ω–¥–ª–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø—Ä–∏–≤—è–∑–∞–Ω –∫¬†onClick */
  return useCallback(() => {
    if (!userId) {
      // –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω¬†‚Äî –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º LoginModal
      setLoginModal(true);
      return;
    }
    mutation.mutate(Boolean(favouritesMap[locationId]));
  }, [mutation, userId, favouritesMap, locationId, setLoginModal]);
}
```

---
### FavouriteFetcher

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `FavouriteFetcher` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—é –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –ª–æ–∫–∞—Ü–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.
* **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  * –ü–æ–ª—É—á–∞–µ—Ç ID —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —Ö—É–∫–∞ `useAuth`.
  * –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –µ–≥–æ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –ª–æ–∫–∞—Ü–∏–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `favourites` –≤ Supabase.
  * –ì–∏–¥—Ä–∞—Ç–∏—Ä—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ Zustand, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—è —Ñ–ª–∞–≥–∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö `location_id`.
  * –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ª–æ–≥–∞—É—Ç–µ) –æ—á–∏—â–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ —É–¥–∞–ª—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∫—ç—à-–∑–∞–ø—Ä–æ—Å—ã –∏–∑ React Query.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ FavouriteFetcher.js:**
```js
'use client';
import { useEffect } from 'react';
import { useAuth } from '@/hooks/useAuth';
import { useQueryClient } from '@tanstack/react-query';
import { supabase } from '@/lib/supabaseClient';
import { useUIStore } from '@/store/uiStore';

export default function FavouriteFetcher() {
  const { user } = useAuth();
  const userId = user?.id;
  const queryClient = useQueryClient();
  const hydrateFavourites = useUIStore((s) => s.hydrateFavourites);

  useEffect(() => {
    if (userId) {
      // –ü—Ä–∏ –ª–æ–≥–∏–Ω–µ ‚Äî –ø–æ–¥–≥—Ä—É–∂–∞–µ–º current favourites
      (async () => {
        try {
          const data = await queryClient.fetchQuery({
            queryKey: ['favourites', userId],
            queryFn: async () => {
              const { data, error } = await supabase
                .from('favourites')
                .select('location_id')
                .eq('user_id', userId);
              if (error) throw error;
              return data;
            },
          });
          // –≥–∏–¥—Ä–∞—Ç–∏—Ä—É–µ–º Zustand-–º—ç–ø: { [locationId]: true }
          hydrateFavourites(data.map((f) => f.location_id));
        } catch (e) {
          console.error('FavouriteFetcher:', e);
        }
      })();
    } else {
      // –ü—Ä–∏ –ª–æ–≥–∞—É—Ç–µ ‚Äî —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ —á–∏—Å—Ç–∏–º –∫–µ—à
      hydrateFavourites([]);
      queryClient.removeQueries({ queryKey: ['favourites'] });
    }
  }, [userId, queryClient, hydrateFavourites]);

  return null;
}
```

---