# **–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏ —Ö—É–∫–æ–≤ BatumiTrip**

> –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è –µ–¥–∏–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∏—Å—Ç–∏–Ω—ã (source¬†of¬†truth) –æ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –∫–æ–¥–∞ –ø—Ä–æ–µ–∫—Ç–∞ Batumi¬†Trip. –û–Ω —Å–ª—É–∂–∏—Ç –æ–ø–æ—Ä–æ–π –¥–ª—è AI‚Äë–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –∫–æ–¥–∞ –∏ –≤—Å–µ–π –∫–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è –¥–µ—Ç–∞–ª—å–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, —Ö—É–∫–æ–≤ –∏ —É—Ç–∏–ª–∏—Ç. –ò—Å–ø–æ–ª—å–∑—É—è —ç—Ç–æ—Ç —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫, AI —Å–º–æ–∂–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥, –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è –ø–æ —Å—Ç–∏–ª—é.

---
## –ê–∫—Ç—É–∞–ª—å–Ω—ã–π –∫–æ–¥ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### Layout.js

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ì–ª–æ–±–∞–ª—å–Ω—ã–π –º–∞–∫–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –æ–±–æ—Ä–∞—á–∏–≤–∞—é—â–∏–π –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã. –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —É—Å—Ç–∞–Ω–æ–≤–∫—É –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ (React Query Provider, Context –¥–ª—è —Ç–µ–º—ã), –ø—Ä–æ–≤–µ—Ä–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –æ–±—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Header` –∏ `LoginModal`).
* **–ü—Ä–æ–ø—Å—ã:** `children: ReactNode` ‚Äî —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ö—É–∫ `useAuth` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–Ω–æ–ø–∫—É –≤—Ö–æ–¥–∞ –≤ `Header`. –í–∫–ª—é—á–∞–µ—Ç –≤ —Ä–∞–∑–º–µ—Ç–∫—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã `Header` –∏ `LoginModal`.
* **–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:** Tailwind CSS –¥–ª—è —Å—Ç–∏–ª–µ–π –º–∞–∫–µ—Ç–∞ –∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ —à—Ä–∏—Ñ—Ç–æ–≤, Context API –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Ç–µ–º—ã –∏–ª–∏ –ª–æ–∫–∞–ª–∏. –í –∫–∞—á–µ—Å—Ç–≤–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–∞—Ö –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è Framer Motion (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Å—Ç—Ä–∞–Ω–∏—Ü).
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ Layout.js:**
```js
import '@/styles/globals.css';
import Providers from '@/components/Providers';

export const metadata = {
  title: 'Batumi¬†Trip',
  description: 'SPA –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –¥—Ä—É–∑–µ–π –≤¬†–ë–∞—Ç—É–º–∏',
};

export default function RootLayout({ children }) {
  return (
    <html lang="ru" suppressHydrationWarning>
      <body>
        <Providers>{children}</Providers>
      </body>
    </html>
  );
}
```

---
### `route.js`¬†‚Äî NextAuth‚Äë—ç–Ω–¥–ø–æ–∏–Ω—Ç `app/api/auth/[...nextauth]/route.js`
* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ HTTP‚Äë–∑–∞–ø—Ä–æ—Å—ã NextAuth (`GET`, `POST`) –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç password‚Äëless‚ÄØ–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é —á–µ—Ä–µ–∑ Credentials Provider. –°–æ–∑–¥–∞—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ç–∞–±–ª–∏—Ü–µ `users`, –µ—Å–ª–∏ —Ç–æ—Ç –≤—Ö–æ–¥–∏—Ç –≤–ø–µ—Ä–≤—ã–µ.
* **–ü—Ä–æ–ø—Å—ã:** –§–∞–π–ª –Ω–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç React‚Äë–∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –ø–æ—ç—Ç–æ–º—É –ø—Ä–æ–ø—Å–æ–≤ –Ω–µ—Ç.
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:**
  * –ü—Ä–∏ `authorize()` –∞–ø—Å—ë—Ä—Ç–∏—Ç –ª–æ–≥–∏–Ω –≤ Supabase `users`.
  * –í callback‚Äô–∞—Ö –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ—Ç `token.id` ‚Üí `session.user.id`, —á—Ç–æ–±—ã RLS‚Äë–ø–æ–ª–∏—Ç–∏–∫–∏ ¬´–∑–Ω–∞–ª–∏¬ª —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å–º. DataModel‚ÄëBatumiTrip.md ¬ß‚ÄØ5).
* **–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:** `next-auth`, `@supabase/supabase-js`, –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π `Credentials`¬†provider, dotenv‚Äë–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `NEXTAUTH_SECRET`.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ route.js:**
```js
import NextAuth from 'next-auth';
import CredentialsProvider from 'next-auth/providers/credentials';
import { supabase } from '@/lib/supabaseClient';

export const authOptions = {
  // 1) –ü—Ä–æ–≤–∞–π–¥–µ—Ä Credentials –±–µ–∑ –ø–∞—Ä–æ–ª—è
  providers: [
    CredentialsProvider({
      name: '',
      credentials: {
        username: { label: '–ö–∞–∫ –º–Ω–µ —Å—Ç–æ–∏—Ç —Ç–µ–±—è –Ω–∞–∑—ã–≤–∞—Ç—å?üßê', type: 'text', placeholder: '–í–≤–µ–¥–∏—Ç–µ –∏–º—è' },
      },
      async authorize(credentials) {
        const username = credentials?.username?.trim();
        if (!username) return null;

        // 1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Supabase
        const { error } = await supabase
          .from('users')
          .upsert({ id: username }, { returning: 'minimal' });
        if (error) {
          console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ upsert –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error);
          throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
        }

        // 2. –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—ä–µ–∫—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è NextAuth
        return { id: username };
      },
    }),
  ],
  // 2) –°–µ—Å—Å–∏–∏ –∏ JWT
  session: {
    strategy: 'jwt',
    maxAge: 30 * 24 * 60 * 60, // 30 –¥–Ω–µ–π
  },
  jwt: {
    secret: process.env.NEXTAUTH_SECRET,
  },
  // 3) –ö–æ–ª–±—ç–∫–∏ –¥–ª—è –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ –∏ session.user
  callbacks: {
    async jwt({ token, user }) {
      // –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –ª–æ–≥–∏–Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º id –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ token
      if (user?.id) token.id = user.id;
      return token;
    },
    async session({ session, token }) {
      // –°—á–∏—Ç—ã–≤–∞–µ–º –∏–∑ Supabase –≤—Å—é –∑–∞–ø–∏—Å—å –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
      if (token.id) {
        const { data: userRecord, error } = await supabase
          .from('users')
          .select('id, created_at, updated_at')
          .eq('id', token.id)
          .single();
        if (error) {
          console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error);
          session.user = { id: token.id };
        } else {
          session.user = userRecord;
        }
      }
      return session;
    },
  },
  // 4) –Ø–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è HTTP-only cookie
  cookies: {
    sessionToken: {
      name:
        process.env.NODE_ENV === 'production'
          ? '__Secure-next-auth.session-token'
          : 'next-auth.session-token',
      options: {
        httpOnly: true,
        sameSite: 'lax',
        path: '/',
        secure: process.env.NODE_ENV === 'production',
      },
    },
  },
  // 5) Secret –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ JWT –∏ CSRF —Ç–æ–∫–µ–Ω–æ–≤
  secret: process.env.NEXTAUTH_SECRET,
};

const handler = NextAuth(authOptions);
export { handler as GET, handler as POST };
```

---
### AuthProvider.js
* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç React‚Äë–¥–µ—Ä–µ–≤–æ –≤ `<SessionProvider>`, –ø–µ—Ä–µ–¥–∞–≤–∞—è –≤–Ω–∏–∑ –¥–∞–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏ NextAuth.&#x20;
* **–ü—Ä–æ–ø—Å—ã:** `children: ReactNode`.
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ `Providers.js`; –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ `useSession()` –≤–æ –≤—Å–µ—Ö –¥–æ—á–µ—Ä–Ω–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö.
* **–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:** `next-auth/react` (SessionProvider), React.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ AuthProvider.js:**
```js
'use client';
import { SessionProvider } from 'next-auth/react';

export default function AuthProvider({ children }) {
  return <SessionProvider>{children}</SessionProvider>;
}
```
---
### LoginModal.js

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∏–∞–ª–æ–≥ —Å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–≤—ã–º –ø–æ–ª–µ–º –¥–ª—è –ª–æ–≥–∏–Ω–∞ –∏ –∫–Ω–æ–ø–∫–æ–π ¬´–í–æ–π—Ç–∏¬ª. –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç `signIn('credentials')`.
* **–ü—Ä–æ–ø—Å—ã:** –ù–µ—Ç; –≤–∏–¥–∏–º–æ—Å—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω—ã–º Zustand‚Äë—Å—Ç–æ—Ä–æ–º `uiStore`.
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:**

  * –ß–∏—Ç–∞–µ—Ç `showLoginModal` –∏ `setLoginModal` –∏–∑ Zustand.
  * –ü–æ `onSubmit` –≤—ã–∑—ã–≤–∞–µ—Ç `signIn`, –∑–∞—Ç–µ–º –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª–∫—É.
  * –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏/–∑–∞–∫—Ä—ã—Ç–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã `Dialog*` –∏–∑ **shadcn**.
* **–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:** `next-auth/react`, Zustand, **shadcn**¬†(`Dialog`, `Input`, `Button`), React.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ LoginModal.js:**
```js
'use client';
import { useState } from 'react';
import { signIn } from 'next-auth/react';
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
  DialogFooter,
} from '@/components/ui/dialog';
import { Input } from '@/components/ui/input';
import { Button } from '@/components/ui/button';
import { useUIStore } from '@/store/uiStore';

export default function LoginModal() {
  const show    = useUIStore((s) => s.showLoginModal);
  const setShow = useUIStore((s) => s.setLoginModal);
  const [login, setLogin] = useState('');

  async function handleSubmit(e) {
    e.preventDefault();
    if (!login.trim()) return;
    await signIn('credentials', { username: login, redirect: false });
    setShow(false);              // –∑–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª–∫—É –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞
  }

  return (
    <Dialog open={show} onOpenChange={setShow}>
      <DialogContent>
        <DialogHeader>
          <DialogTitle>–í–æ–π—Ç–∏ –±–µ–∑¬†–ø–∞—Ä–æ–ª—è</DialogTitle>
        </DialogHeader>

        <form onSubmit={handleSubmit} className="space-y-4">
          <Input
            placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω"
            value={login}
            onChange={(e) => setLogin(e.target.value)}
          />

          <DialogFooter>
            <Button type="submit" className="w-full">
              –í–æ–π—Ç–∏
            </Button>
          </DialogFooter>
        </form>
      </DialogContent>
    </Dialog>
  );
}
```

---
### Providers.js

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ï–¥–∏–Ω–æ–∂–¥—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç `QueryClient`, –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ React¬†Query, Auth –∏ Theme –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã; –ø–æ–¥–∫–ª—é—á–∞–µ—Ç Devtools –≤¬†dev‚Äë—Å—Ä–µ–¥–µ.&#x20;
* **–ü—Ä–æ–ø—Å—ã:** `children: ReactNode`.
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:**

  * –°–æ–∑–¥–∞—ë—Ç `queryClient` —á–µ—Ä–µ–∑ `createQueryClient()` (—Å–º. `lib/reactQuery.js`).
  * –í–∫–ª—é—á–∞–µ—Ç `<ReactQueryDevtools />` —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `NODE_ENV !== 'production'`.
* **–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:** `@tanstack/react-query`, `@tanstack/react-query-devtools`, React, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ `AuthProvider`, `ThemeProvider`.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ Providers.js:**
```js
'use client';
import { useState } from 'react';
import { QueryClientProvider } from '@tanstack/react-query';
import { ReactQueryDevtools } from '@tanstack/react-query-devtools';

import { createQueryClient } from '@/lib/reactQuery';
import AuthProvider from '@/components/AuthProvider';
import ThemeProvider from '@/components/ThemeProvider';

export default function Providers({ children }) {
  const [queryClient] = useState(() => createQueryClient());

  return (
    <QueryClientProvider client={queryClient}>
      <AuthProvider>
        <ThemeProvider>{children}</ThemeProvider>
      </AuthProvider>

      {process.env.NODE_ENV !== 'production' && <ReactQueryDevtools />}
    </QueryClientProvider>
  );
}
```

---
### ThemeProvider.js

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–µ–ª–µ–≥–∏—Ä—É–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–æ–π –ø–∞–∫–µ—Ç—É `next-themes`; –¥–æ–±–∞–≤–ª—è–µ—Ç/—É–¥–∞–ª—è–µ—Ç –∫–ª–∞—Å—Å `dark` –Ω–∞ –∫–æ—Ä–Ω–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞.&#x20;
* **–ü—Ä–æ–ø—Å—ã:** `children: ReactNode`.
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ `Providers.js`; —á–∏—Ç–∞–µ—Ç/–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ç–µ–º—É –≤ `localStorage` (–º–µ—Ö–∞–Ω–∏–∑–º `next-themes`).
* **–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:** `next-themes`, React.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ Providers.js:**
```js
'use client';
import { ThemeProvider as NextThemesProvider } from 'next-themes';

export default function ThemeProvider({ children }) {
  return (
    <NextThemesProvider attribute="class" defaultTheme="black">
      {children}
    </NextThemesProvider>
  );
}
```

---
## –ê–∫—Ç—É–∞–ª—å–Ω—ã–π –∫–æ–¥ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ —Ö—É–∫–æ–≤ / —É—Ç–∏–ª–∏—Ç

### –•—É–∫ useAuth.js

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–∞—Å—Ç–æ–º–Ω—ã–π —Ö—É–∫ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
* **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç NextAuth.js (`useSession`) –∏–ª–∏ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç HTTP-only cookie `next-auth.session-token`. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç `user` (–æ–±—ä–µ–∫—Ç —Å `id`), —Ñ–ª–∞–≥ `isLoading` –∏ –º–µ—Ç–æ–¥—ã `signIn(username)` –∏ `signOut()`. –ü—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ `useAuth` –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–µ—Å—Å–∏—é –∏–∑ cookie –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –µ–µ —Å –≥–ª–æ–±–∞–ª—å–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, React Context –∏–ª–∏ Zustand).
* **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ `Layout` –¥–ª—è –∑–∞—â–∏—Ç—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤; –≤ `LoginModal` –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Ö–æ–¥–∞; –≤ `Header` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –∫–∞–∫—É—é –∫–Ω–æ–ø–∫—É –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å. –í —Å–≤—è–∑–∏ —Å —ç—Ç–∏–º –≤ `Layout` –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è `router.push('/login')`, –µ—Å–ª–∏ —Å–µ—Å—Å–∏—è –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ useAuth.js:**
```js
'use client';
import { useSession, signIn, signOut } from 'next-auth/react';

export function useAuth() {
  const { data: session, status } = useSession();
  return {
    user: session?.user ?? null,
    isLoading: status === 'loading',
    signIn,
    signOut,
  };
}
```

---
### –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (Zustand –∏ Context)

* **Zustand Store:** –£–ø—Ä–∞–≤–ª—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–º UI-—Å–æ—Å—Ç–æ—è–Ω–∏–µ–º, –Ω–µ –æ—Ç–Ω–æ—Å—è—â–∏–º—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É. –ù–∞–ø—Ä–∏–º–µ—Ä:

  * `searchQuery` ‚Äî —Ç–µ–∫—É—â–∏–π —Ç–µ–∫—Å—Ç –ø–æ–∏—Å–∫–∞ (–∏–∑ `SearchBar`)
  * `selectedTags: string[]` ‚Äî –º–∞—Å—Å–∏–≤ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ç–µ–≥–æ–≤ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
  * `showLoginModal: boolean` ‚Äî —Ñ–ª–∞–≥ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è `LoginModal`
  * `favorites: string[]` ‚Äî —Å–ø–∏—Å–æ–∫ ID –æ—Ç–º–µ—á–µ–Ω–Ω—ã—Ö –ª–æ–∫–∞—Ü–∏–π (–∏–∑ –∑–∞–¥–∞—á–∏ ¬´–∏–∑–±—Ä–∞–Ω–Ω–æ–µ¬ª; –º–æ–∂–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ localStorage)
  * –ú–µ—Ç–æ–¥—ã `setSearchQuery`, `toggleTag`, `setLoginModal`, `toggleFavorite` –∏ —Ç.–¥.
* **Context API:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –æ–ø—Ü–∏–π, –Ω–∞–ø—Ä–∏–º–µ—Ä `ThemeContext` (—Å–≤–µ—Ç–ª–∞—è/—Ç–µ–º–Ω–∞—è —Ç–µ–º–∞) –∏–ª–∏ `LocaleContext` (—è–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞). –û–±—ã—á–Ω–æ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –≤ `Layout`.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ uiStore.js:**
```js
import { create } from 'zustand';
import { persist } from 'zustand/middleware';

export const useUIStore = create(
  persist(
    (set, get) => ({
      searchQuery: '',
      selectedTags: [],
      showLoginModal: false,
      favourites: {},

      setSearchQuery: (q) => set({ searchQuery: q }),
      toggleTag: (tag) =>
        set((s) => ({
          selectedTags: s.selectedTags.includes(tag)
            ? s.selectedTags.filter((t) => t !== tag)
            : [...s.selectedTags, tag],
        })),
      setLoginModal: (v) => set({ showLoginModal: v }),

      toggleFavourite: (id) =>
        set((s) => ({ favourites: { ...s.favourites, [id]: !s.favourites[id] } })),

      hydrateFavourites: (ids) =>
        set(() => ({ favourites: Object.fromEntries(ids.map((id) => [id, true])) })),
    }),
    {
      name: 'batumi-ui',
      partialize: (s) => ({ favourites: s.favourites }),
    }
  )
);
```

---
### reactQuery.js

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—ë—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π `QueryClient` c¬†–Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∫–µ—à–∞ –∏ —Ä–µ—Ç—Ä–∞–µ–≤, —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–º–∏ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π.&#x20;
* **–ü—Ä–æ–ø—Å—ã:** –ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ (utility‚Äë—Ñ—É–Ω–∫—Ü–∏—è).
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ –≤ `Providers.js`; –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ö—É–∫–∏ (`useLocations`,¬†`useAddLocation`¬†–∏¬†–¥—Ä.) –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ—Ç –∂–µ —ç–∫–∑–µ–º–ø–ª—è—Ä.
* **–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:** `@tanstack/react-query`.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ reactQuery.js:**
```js
import { QueryClient } from '@tanstack/react-query';

export function createQueryClient() {
  return new QueryClient({
    defaultOptions: {
      queries: {
        staleTime: 1000 * 60,       // 1 –º–∏–Ω—É—Ç–∞
        gcTime: 1000 * 60 * 30,  // 30 –º–∏–Ω—É—Ç
        refetchOnWindowFocus: false,
        retry: 1,
      },
      mutations: {
        networkMode: 'always',
      },
    },
  });
}
```

---

### supabaseClient.js

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä Supabase JS SDK —Å `anon`‚Äë–∫–ª—é—á–æ–º –∏ URL –∏–∑ env‚Äë–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.&#x20;
* **–ü—Ä–æ–ø—Å—ã:** ‚Äî
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ API‚Äë—Ä–æ—É—Ç–µ `route.js`, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ö—É–∫–∞—Ö (CRUD) –∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ Storage.
* **–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:** `@supabase/supabase-js`.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ supabaseClient.js:**
```js
import { createClient } from '@supabase/supabase-js';

export const supabase = createClient(
  process.env.NEXT_PUBLIC_SUPABASE_URL,
  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY
);
```

---
### utils.js

* **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—ä–µ–¥–∏–Ω—è–µ—Ç —É—Å–ª–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã —Å¬†–ø–æ–º–æ—â—å—é `clsx`, –∞ –∑–∞—Ç–µ–º ¬´—Å–∫–ª–µ–∏–≤–∞–µ—Ç¬ª –≤–æ–∑–º–æ–∂–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã —á–µ—Ä–µ–∑ `tailwind-merge`.&#x20;
* **–ü—Ä–æ–ø—Å—ã:** ‚Äî
* **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤–æ –≤—Å–µ—Ö React‚Äë–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö, –≥–¥–µ –Ω—É–∂–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å className.
* **–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:** `clsx`, `tailwind-merge`.
**–ê–∫—Ç–∞—É–ª—å–Ω—ã–π –∫–æ–¥ utils.js:**
```js
import { clsx } from "clsx";
import { twMerge } from "tailwind-merge"

export function cn(...inputs) {
  return twMerge(clsx(inputs));
}
```

---
